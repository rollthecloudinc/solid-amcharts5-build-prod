(self.webpackChunkplugin_amcharts5=self.webpackChunkplugin_amcharts5||[]).push([[6197],{7289:(H,B,b)=>{b.d(B,{Annotator:()=>P,Exporting:()=>E,ExportingMenu:()=>T});var m=b(84911),O=b(79522),j=b(11951),G=b(71603),h=b(43933),_=b(15784),w=b(17679),D=b(50886);let N;class E extends O.JH{_afterNew(){super._afterNew(),this._setRawDefault("filePrefix","chart"),this._setRawDefault("charset","utf-8"),this._setRawDefault("numericFields",[]),this._setRawDefault("dateFields",[]),this._setRawDefault("durationFields",[]),this._setRawDefault("extraImages",[]),this._setRawDefault("pngOptions",{quality:1,maintainPixelRatio:!1}),this._setRawDefault("jpgOptions",{quality:.8,maintainPixelRatio:!1}),this._setRawDefault("printOptions",{quality:1,maintainPixelRatio:!1,delay:500,printMethod:"iframe",imageFormat:"png"}),this._setRawDefault("jsonOptions",{indent:2,renameFields:!0}),this._setRawDefault("csvOptions",{separator:",",addColumnNames:!0,emptyAs:"",addBOM:!0}),this._setRawDefault("htmlOptions",{emptyAs:"-",addColumnNames:!0}),this._setRawDefault("xlsxOptions",{emptyAs:"",addColumnNames:!0}),this._setRawDefault("pdfOptions",{fontSize:14,imageFormat:"png",align:"left",addURL:!0}),this._setRawDefault("pdfdataOptions",{emptyAs:"",addColumnNames:!0}),this._root.addDisposer(this)}_beforeChanged(){if(super._beforeChanged(),this.isDirty("menu")){const t=this.get("menu");t&&(t.set("exporting",this),this._disposers.push(t))}}_getFormatOptions(t,e){const s=w.JG(this.get(t+"Options",{}));return e&&w.S6(e,(i,o)=>{s[i]=o}),s}download(t,e){return(0,m.mG)(this,void 0,void 0,function*(){const s="pdfdata"==t?"pdf":t,i=this.get("filePrefix","chart")+"."+s,o=this._getFormatOptions(t,e);this.events.dispatch("downloadstarted",{type:"downloadstarted",format:t,options:o,fileName:i,target:this});const a=yield this.export(t,o);this.streamFile(a,i,o&&o.addBOM)})}print(t){return(0,m.mG)(this,void 0,void 0,function*(){const e=this._getFormatOptions("print",t);this.events.dispatch("printstarted",{type:"printstarted",format:"print",options:e,target:this});const s=yield this.export(e.imageFormat||"png",e);this.initiatePrint(s,e,this.get("title"))})}export(t,e){return(0,m.mG)(this,void 0,void 0,function*(){const s=this._getFormatOptions(t,e);this.events.dispatch("exportstarted",{type:"exportstarted",format:t,options:s,target:this});let i="";switch(t){case"png":case"jpg":this._root._runTickerNow(),i=this.exportImage(t,s);break;case"json":i=this.exportJSON(s);break;case"csv":i=this.exportCSV(s);break;case"html":i=this.exportHTML(s);break;case"xlsx":i=this.exportXLSX(s);break;case"pdf":this._root._runTickerNow(),i=this.exportPDF(s);break;case"pdfdata":i=this.exportPDFData(s)}return this.events.dispatch("exportfinished",{type:"exportfinished",format:t,options:s,target:this}),i})}exportImage(t,e){return(0,m.mG)(this,void 0,void 0,function*(){const s=this._getFormatOptions(t,e),i=yield this.getCanvas(s),o=i.toDataURL(this.getContentType(t),s.quality||1);return this.disposeCanvas(i),o})}exportCanvas(t){return(0,m.mG)(this,void 0,void 0,function*(){const e=this._getFormatOptions("canvas",t),s=yield this.getCanvas(e),i=s.toDataURL(this.getContentType("canvas"),e.quality||1);return this.disposeCanvas(s),i})}getCanvas(t){return(0,m.mG)(this,void 0,void 0,function*(){const e=this._root._renderer.getCanvas(this._root._rootContainer._display,t),s=this.get("extraImages",[]);let i=0,o=0,a=e.width,n=e.height,d=0,r=0;const l=[];_.S6(s,v=>{let c;c=v instanceof G.f?{source:v,position:"bottom"}:v,c.position=c.position||"bottom",c.marginTop=c.marginTop||0,c.marginRight=c.marginRight||0,c.marginBottom=c.marginBottom||0,c.marginLeft=c.marginLeft||0;const M=c.source._renderer.getCanvas(c.source._rootContainer._display,t),F=M.width+c.marginLeft+c.marginRight,R=M.height+c.marginTop+c.marginBottom;"top"==c.position?(a=c.crop?n:Math.max(a,F),o+=R):"right"==c.position?(n=c.crop?n:Math.max(n,R),d+=F):"left"==c.position?(n=c.crop?n:Math.max(n,R),i+=F):"bottom"===c.position&&(a=c.crop?n:Math.max(a,F),r+=R),l.push({canvas:M,position:c.position,left:c.marginLeft,top:c.marginTop,width:F,height:R})});const p=this.getDisposableCanvas();p.width=i+a+d,p.height=o+n+r;const u=p.getContext("2d"),x=this.get("backgroundColor",this.findBackgroundColor(this._root.dom)),y=this.get("backgroundOpacity",1);x&&(u.fillStyle=x.toCSS(y),u.fillRect(0,0,p.width,p.height));let S=i,f=o,C=S+a,I=f+n;return _.S6(l,v=>{"top"==v.position?(f-=v.height,u.drawImage(v.canvas,i+v.left,f+v.top)):"right"==v.position?(u.drawImage(v.canvas,C+v.left,o+v.top),C+=v.width):"left"==v.position?(S-=v.width,u.drawImage(v.canvas,S+v.left,o+v.top)):"bottom"===v.position&&(u.drawImage(v.canvas,i+v.left,I+v.top),I+=v.height)}),u.drawImage(e,i,o),p})}exportJSON(t){return(0,m.mG)(this,void 0,void 0,function*(){return"data:"+this.getContentType("json")+";"+this.get("charset","utf-8")+","+encodeURIComponent(yield this.getJSON(t))})}getJSON(t){return(0,m.mG)(this,void 0,void 0,function*(){const e=this._getFormatOptions("json",t);return JSON.stringify(this.getData("json",t,e.renameFields),(s,i)=>(D.Kn(i)&&w.S6(i,(o,a)=>{i[o]=this.convertToSpecialFormat(o,a,e)}),i),e.indent)})}exportCSV(t){return(0,m.mG)(this,void 0,void 0,function*(){return"data:"+this.getContentType("csv")+";"+this.get("charset","utf-8")+","+encodeURIComponent(yield this.getCSV(t))})}getCSV(t){return(0,m.mG)(this,void 0,void 0,function*(){const e=this._getFormatOptions("csv",t);let s="",i="";const o=this.getData("csv",e),a=this.getDataFields(o);if(e.pivot){const n=this.get("dataFieldsOrder",[]);w.JE(a,(d,r)=>{let l=[];e.addColumnNames&&l.push(r);for(let p=o.length,u=0;u<p;u++)l.push(this.convertToSpecialFormat(d,o[u][d],e,!0));s+=i+this.getCSVRow(l,e,void 0,!0),i="\n"},(d,r)=>{let l=n.indexOf(d),p=n.indexOf(r);return l>p?-1:l<p?1:0})}else{for(let n=o.length,d=0;d<n;d++){let r=this.getCSVRow(o[d],e,a);e.reverse?s=r+i+s:s+=i+r,i="\n"}e.addColumnNames&&(s=this.getCSVRow(a,e,void 0,!0)+i+s)}return s})}getCSVRow(t,e,s,i=!1){let o=e.separator||",",a=[];s||(s={},w.S6(t,(d,r)=>{s[d]=r}));const n=this.get("dataFieldsOrder",[]);return w.JE(s,(d,r)=>{let l=this.convertEmptyValue(d,t[d],e),p=i?l:this.convertToSpecialFormat(d,l,e);p=""+p,p=p.replace(/"/g,'""'),(e.forceQuotes||p.search(new RegExp('"|\n|'+o,"g"))>=0)&&(p='"'+p+'"'),a.push(p)},(d,r)=>{let l=n.indexOf(d),p=n.indexOf(r);return l>p?1:l<p?-1:0}),a.join(o)}exportHTML(t){return(0,m.mG)(this,void 0,void 0,function*(){return"data:"+this.getContentType("html")+";"+this.get("charset","utf-8")+","+encodeURIComponent(yield this.getHTML(t))})}getHTML(t){return(0,m.mG)(this,void 0,void 0,function*(){const e=this._getFormatOptions("html",t);let s="<table>";e.tableClass&&(s='<table class="'+e.tableClass+'">');const i=this.getData("html",e),o=this.getDataFields(i);if(e.pivot){const a=this.get("dataFieldsOrder",[]);s+="\n<tbody>",w.JE(o,(n,d)=>{let r=[];e.addColumnNames&&r.push(d);for(let l=i.length,p=0;p<l;p++)r.push(this.convertToSpecialFormat(n,i[p][n],e,!0));s+="\n"+this.getHTMLRow(r,e,void 0,!0)},(n,d)=>{let r=a.indexOf(n),l=a.indexOf(d);return r>l?-1:r<l?1:0}),s+="\n</tbody>"}else{e.addColumnNames&&(s+="\n<thead>\n"+this.getHTMLRow(o,e,void 0,!0,!0)+"\n</thead>"),s+="\n<tbody>";for(let a=i.length,n=0;n<a;n++)s+="\n"+this.getHTMLRow(i[n],e,o);s+="\n</tbody>"}return s+="\n</table>",s})}getHTMLRow(t,e,s,i=!1,o=!1){let a="\t<tr>";e.rowClass&&(a='\t<tr class="'+e.rowClass+'">'),s||(s=t);const n=this.get("dataFieldsOrder",[]),d=o?"th":"td";let r=!0;return w.JE(s,(l,p)=>{let u=this.convertEmptyValue(l,t[l],e),x=i?u:this.convertToSpecialFormat(l,u,e);x=""+x,x=x.replace(/[\u00A0-\u9999<>\&]/gim,function(S){return"&#"+S.charCodeAt(0)+";"});let y=d;e.pivot&&r&&(y="th"),a+=e.cellClass?"\n\t\t<"+y+' class="'+e.cellClass+'">'+x+"</"+y+">":"\n\t\t<"+y+">"+x+"</"+y+">",r=!1},(l,p)=>{let u=n.indexOf(l),x=n.indexOf(p);return u>x?1:u<x?-1:0}),a+="\n\t</tr>",a}exportXLSX(t){return(0,m.mG)(this,void 0,void 0,function*(){return"data:"+this.getContentType("xlsx")+";"+this.get("charset","utf-8")+","+encodeURIComponent(yield this.getXLSX(t))})}getXLSX(t){return(0,m.mG)(this,void 0,void 0,function*(){const e=this._getFormatOptions("xlsx",t);let s=yield this.getXLSXLib(),i={bookType:"xlsx",bookSST:!1,type:"base64"},o=this._normalizeExcelSheetName(this.get("title",this._t("Data"))),a={SheetNames:[o],Sheets:{}},n=[];const d=this.getData("html",e),r=this.getDataFields(d);if(e.pivot){const l=this.get("dataFieldsOrder",[]);w.JE(r,(p,u)=>{let x=[];e.addColumnNames&&x.push(u);for(let y=d.length,S=0;S<y;S++)x.push(this.convertToSpecialFormat(p,d[S][p],e,!0));n.push(this.getXLSXRow(x,e,void 0,!0))},(p,u)=>{let x=l.indexOf(p),y=l.indexOf(u);return x>y?1:x<y?-1:0})}else{e.addColumnNames&&n.push(this.getXLSXRow(r,e,void 0,!0));for(let l=d.length,p=0;p<l;p++)n.push(this.getXLSXRow(d[p],e,r))}return a.Sheets[o]=s.utils.aoa_to_sheet(n),this.events.dispatch("workbookready",{type:"workbookready",format:"xlsx",options:e,workbook:a,workbookOptions:i,xlsx:s,target:this}),s.write(a,i)})}_normalizeExcelSheetName(t){return(t=t.replace(/([:\\\/?*\[\]]+)/g," ")).length>30?t.substr(0,30)+"...":t}getXLSXRow(t,e,s,i=!1){let o=[];s||(s=t);const a=this.get("dataFieldsOrder",[]);return w.JE(s,(n,d)=>{let r=this.convertEmptyValue(n,t[n],e),l=i?r:this.convertToSpecialFormat(n,r,e,!0);o.push(l)},(n,d)=>{let r=a.indexOf(n),l=a.indexOf(d);return r>l?1:r<l?-1:0}),o}_xlsx(){return(0,m.mG)(this,void 0,void 0,function*(){return yield b.e(4297).then(b.bind(b,24402))})}getXLSXLib(){return this._xlsx()}exportPDF(t){return(0,m.mG)(this,void 0,void 0,function*(){return"data:"+this.getContentType("pdf")+";"+this.get("charset","utf-8")+","+encodeURIComponent(yield this.getPDF(t,!0))})}exportPDFData(t){return(0,m.mG)(this,void 0,void 0,function*(){return"data:"+this.getContentType("pdf")+";"+this.get("charset","utf-8")+","+encodeURIComponent(yield this.getPDF(t,!1,!0))})}getPDF(t,e=!0,s=!1){return(0,m.mG)(this,void 0,void 0,function*(){const i=this._getFormatOptions("pdf",t),o=this._getFormatOptions("pdfdata",t),a=i.pageOrientation||"portrait";let n;e&&(n=yield this.exportImage(i.imageFormat||"png",i));const d=yield this.getPdfmake();let l={pageSize:i.pageSize||"A4",pageOrientation:a,pageMargins:i.pageMargins||[30,30,30,30],defaultStyle:{font:i.font?i.font.name:void 0},content:[]};const p=this.get("title");let u=0;p&&(l.content.push({text:p,fontSize:i.fontSize||14,bold:!0,margin:[0,0,0,15]}),u+=50),i.addURL&&(l.content.push({text:this._t("Saved from")+": "+document.location.href,fontSize:i.fontSize,margin:[0,0,0,15]}),u+=50),e&&n&&l.content.push({image:n,alignment:i.align||"left",fit:this.getPageSizeFit(l.pageSize,l.pageMargins,u,a)}),(s||i.includeData)&&this.hasData()&&l.content.push({table:yield this.getPDFData(o),fontSize:i.fontSize||14});let x=null,y=null;function S(f){const C={};C.normal=f.normal.path,y[f.normal.path]=f.normal.bytes,f.bold?(C.bold=f.bold.path,y[f.bold.path]=f.bold.bytes):C.bold=f.normal.path,f.italics?(C.italics=f.italics.path,y[f.italics.path]=f.italics.bytes):C.italics=f.normal.path,f.bolditalics?(C.bolditalics=f.bolditalics.path,y[f.bolditalics.path]=f.bolditalics.bytes):C.bolditalics=f.normal.path,x[f.name]=C}return i.font&&(x={},y={},S(i.font),i.extraFonts&&_.S6(i.extraFonts,S)),this.events.dispatch("pdfdocready",{type:"pdfdocready",format:"pdf",options:i,doc:l,target:this}),new Promise((f,C)=>{d.createPdf(l,null,x,y).getBase64(I=>{f(I)})})})}getPDFData(t){return(0,m.mG)(this,void 0,void 0,function*(){const e=this._getFormatOptions("pdfdata",t);let s={body:[]};const i=this.getData("html",e),o=this.getDataFields(i);if(e.pivot){const a=this.get("dataFieldsOrder",[]);w.JE(o,(n,d)=>{let r=[];e.addColumnNames&&r.push(d);for(let l=i.length,p=0;p<l;p++)r.push(this.convertToSpecialFormat(n,i[p][n],e,!0));s.body.push(this.getPDFDataRow(r,e,void 0,!0))},(n,d)=>{let r=a.indexOf(n),l=a.indexOf(d);return r>l?1:r<l?-1:0})}else{e.addColumnNames&&(s.body.push(this.getPDFDataRow(o,e,void 0,!0)),s.headerRows=1);for(let a=i.length,n=0;n<a;n++)s.body.push(this.getPDFDataRow(i[n],e,o))}return s})}getPDFDataRow(t,e,s,i=!1){let o=[];s||(s=t);const a=this.get("dataFieldsOrder",[]);return w.JE(s,(n,d)=>{let r=this.convertEmptyValue(n,t[n],e),l=i?r:this.convertToSpecialFormat(n,r,e);l=""+l,o.push(l)},(n,d)=>{let r=a.indexOf(n),l=a.indexOf(d);return r>l?1:r<l?-1:0}),o}getPdfmake(){return void 0===N&&(N=function J(){return(0,m.mG)(this,void 0,void 0,function*(){let g=yield Promise.all([b.e(643).then(b.t.bind(b,40496,23)),b.e(643).then(b.bind(b,90852))]),t=g[0].default,e=g[1].default;const s=window;return s.pdfMake=s.pdfMake||{},s.pdfMake.vfs=e,t.vfs=e,t})}()),N}getPageSizeFit(t,e,s=0,i="portrait"){let o=[0,0,0,0];D.hj(e)?o=[e,e,e,e]:2==e.length?o=[e[0],e[1],e[0],e[1]]:4==e.length&&(o=e);let n={"4A0":[4767.87,6740.79],"2A0":[3370.39,4767.87],A0:[2383.94,3370.39],A1:[1683.78,2383.94],A2:[1190.55,1683.78],A3:[841.89,1190.55],A4:[595.28,841.89],A5:[419.53,595.28],A6:[297.64,419.53],A7:[209.76,297.64],A8:[147.4,209.76],A9:[104.88,147.4],A10:[73.7,104.88],B0:[2834.65,4008.19],B1:[2004.09,2834.65],B2:[1417.32,2004.09],B3:[1000.63,1417.32],B4:[708.66,1000.63],B5:[498.9,708.66],B6:[354.33,498.9],B7:[249.45,354.33],B8:[175.75,249.45],B9:[124.72,175.75],B10:[87.87,124.72],C0:[2599.37,3676.54],C1:[1836.85,2599.37],C2:[1298.27,1836.85],C3:[918.43,1298.27],C4:[649.13,918.43],C5:[459.21,649.13],C6:[323.15,459.21],C7:[229.61,323.15],C8:[161.57,229.61],C9:[113.39,161.57],C10:[79.37,113.39],RA0:[2437.8,3458.27],RA1:[1729.13,2437.8],RA2:[1218.9,1729.13],RA3:[864.57,1218.9],RA4:[609.45,864.57],SRA0:[2551.18,3628.35],SRA1:[1814.17,2551.18],SRA2:[1275.59,1814.17],SRA3:[907.09,1275.59],SRA4:[637.8,907.09],EXECUTIVE:[521.86,756],FOLIO:[612,936],LEGAL:[612,1008],LETTER:[612,792],TABLOID:[792,1224]}[t];return"landscape"==i&&n.reverse(),n[0]-=o[0]+o[2],n[1]-=o[1]+o[3]+s,n}hasData(){const t=this.get("dataSource");return!(!D.kJ(t)||!t.length)}getData(t,e,s=!1){const i=this._getFormatOptions(t,e),o=this.get("dataSource",[]);let a=o;const n=this.get("dataFields");n&&D.kJ(o)&&(a=[],_.S6(o,r=>{if(D.Kn(r)){const l={};w.S6(n,(p,u)=>{null!=n[p]&&(l[s?u:p]=this.convertToSpecialFormat(p,r[p],i))}),a.push(l)}}));const d={type:"dataprocessed",format:t,options:i,data:a,target:this};return this.events.dispatch("dataprocessed",d),d.data}getDataFields(t){let e=this.get("dataFields");return e||(e={},D.kJ(t)&&t.length&&_.S6(t,s=>{w.S6(s,(i,o)=>{null==e[i]&&(e[i]=i)})})),e}convertEmptyValue(t,e,s){return e??s.emptyAs}convertToSpecialFormat(t,e,s,i){if("number"==typeof e)if(this.isDateField(t))e=new Date(e);else{if(this.isNumericField(t)&&this.get("numberFormat"))return this._root.numberFormatter.format(e,this.get("numberFormat"));if(this.isDurationField(t))return this._root.durationFormatter.format(e,this.get("durationFormat"),this.get("durationUnit"))}return e instanceof Date&&(s.useTimestamps?e=e.getTime():s.useLocale?i||(e=e.toLocaleString()):e=this._root.dateFormatter.format(e,this.get("dateFormat"))),e}isDateField(t){return-1!==this.get("dateFields").indexOf(t)}isNumericField(t){return-1!==this.get("numericFields").indexOf(t)}isDurationField(t){return-1!==this.get("durationFields").indexOf(t)}getContentType(t){let e="";switch(t){case"png":e="image/"+t;break;case"jpg":e="image/jpeg";break;case"csv":e="text/csv";break;case"json":e="application/json";break;case"html":e="text/html";break;case"pdf":case"pdfdata":e="application/pdf";break;case"xlsx":e="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";break;default:e="application/octet-stream"}return e}getDisposableCanvas(){let t=document.createElement("canvas");return t.style.position="fixed",t.style.top="-10000px",this._root.dom.appendChild(t),t}disposeCanvas(t){this._root.dom.removeChild(t)}findBackgroundColor(t){let e=1,s=getComputedStyle(t,"background-color").getPropertyValue("background-color");if((s.match(/[^,]*,[^,]*,[^,]*,[ ]?0/)||"transparent"==s)&&(e=0),0==e){let i=t.parentElement;return i?this.findBackgroundColor(i):j.Il.fromHex(16777215)}return j.Il.fromCSS(s)}streamFile(t,e,s=!1){if(this.blobDownloadSupport()){let i=document.createElement("a");i.download=e,document.body.appendChild(i);let o=t.split(";"),a=o.shift().replace(/data:/,"");if(t=decodeURIComponent(o.join(";").replace(/^[^,]*,/,"")),-1!=["image/svg+xml","application/json","text/csv","text/html"].indexOf(a)){s&&(t="\ufeff"+t);let l=new Blob([t],{type:a}),p=window.URL.createObjectURL(l);return i.href=p,i.download=e,i.click(),setTimeout(()=>{document.body.removeChild(i),window.URL.revokeObjectURL(p)},100),!0}try{t=atob(t)}catch{return!1}let n=new Array(t.length);for(let l=0;l<t.length;++l){let p=t.charCodeAt(l);n[l]=p}s&&(n=[239,187,191].concat(n));let d=new Blob([new Uint8Array(n)],{type:a}),r=window.URL.createObjectURL(d);i.href=r,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),setTimeout(()=>{window.URL.revokeObjectURL(r)},100)}else if(this.linkDownloadSupport()){let i=document.createElement("a");i.download=e,i.href=t,document.body.appendChild(i),i.click(),document.body.removeChild(i)}else window.location.href=t;return!0}downloadSupport(){return this.linkDownloadSupport()}linkDownloadSupport(){return typeof document.createElement("a").download<"u"}blobDownloadSupport(){return null!=window.Blob}initiatePrint(t,e,s){const i=this._getFormatOptions("print",e);"css"==i.printMethod?this._printViaCSS(t,i,s):this._printViaIframe(t,i,s)}_printViaCSS(t,e,s){let d,o=this._getFormatOptions("print",e).delay||500,a=document.documentElement.scrollTop||document.body.scrollTop,n=new h.u0(h.Ay(this._root.dom),"body > *",{display:"none",position:"fixed",visibility:"hidden",opacity:"0",clipPath:"polygon(0px 0px,0px 0px,0px 0px,0px 0px);"},this._root.nonce);s&&document&&document.title&&(d=document.title,document.title=s);let r=new Image;r.src=t,r.style.maxWidth="100%",r.style.display="block",r.style.position="relative",r.style.visibility="visible",r.style.opacity="1",r.style.clipPath="none",document.body.appendChild(r),this.setTimeout(()=>{window.print()},50),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&o<1e3?o=1e3:o<100&&(o=100),this.setTimeout(()=>{document.body.removeChild(r),n.dispose(),d&&(document.title=document.title),document.documentElement.scrollTop=document.body.scrollTop=a},o||500)}_printViaIframe(t,e,s){let o=this._getFormatOptions("print",e).delay||500;const a=document.createElement("iframe");a.style.visibility="hidden",document.body.appendChild(a),a.contentWindow.document.open(),a.contentWindow.document.close();let n=new Image;n.src=t,n.style.maxWidth="100%",n.style.height="auto",s&&(a.contentWindow.document.title=s),a.contentWindow.document.body.appendChild(n),a.load=function(){a.contentWindow.document.body.appendChild(n)},this.setTimeout(()=>{try{a.contentWindow.document.execCommand("print",!1,null)||a.contentWindow.print()}catch{a.contentWindow.print()}},o||50),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&o<1e3?o=1e3:o<100&&(o=100),this.setTimeout(()=>{document.body.removeChild(a)},o+50||100)}supportedFormats(){const t=[],e=this.hasData(),s=this.downloadSupport();return _.S6(["png","jpg","canvas","pdf","xlsx","csv","json","html","pdfdata","print"],i=>{!0!==this._getFormatOptions(i).disabled&&(-1==["xlsx","csv","json","html","pdfdata"].indexOf(i)||e&&s)&&t.push(i)}),t}supportedExportTypes(){const t=["image","print"];return this.downloadSupport()&&this.hasData()&&t.push("data"),t}}Object.defineProperty(E,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Exporting"}),Object.defineProperty(E,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:O.JH.classNames.concat([E.className])});var L=b(42863);let k;class T extends O.JH{constructor(){super(...arguments),Object.defineProperty(this,"_menuElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_iconElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_listElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_itemElements",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_itemDisposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_cssDisposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_activeItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isOver",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){super._afterNew(),this._setRawDefault("container",this._root._inner),this._setRawDefault("align","right"),this._setRawDefault("valign","top"),this._setRawDefault("useDefaultCSS",!0),this._setRawDefault("autoClose",!0),this._setRawDefault("deactivateRoot",!0),this._setRawDefault("items",[{type:"separator",label:this._t("Export")},{type:"format",format:"png",exportType:"image",label:this._t("PNG"),sublabel:this._t("Image")},{type:"format",format:"jpg",exportType:"image",label:this._t("JPG"),sublabel:this._t("Image")},{type:"format",format:"pdf",exportType:"image",label:this._t("PDF"),sublabel:this._t("Image")},{type:"separator",exportType:"data"},{type:"format",format:"json",exportType:"data",label:this._t("JSON"),sublabel:this._t("Data")},{type:"format",format:"csv",exportType:"data",label:this._t("CSV"),sublabel:this._t("Data")},{type:"format",format:"xlsx",exportType:"data",label:this._t("XLSX"),sublabel:this._t("Data")},{type:"format",format:"pdfdata",exportType:"data",label:this._t("PDF"),sublabel:this._t("Data")},{type:"format",format:"html",exportType:"data",label:this._t("HTML"),sublabel:this._t("Data")},{type:"separator"},{type:"format",format:"print",exportType:"print",label:this._t("Print")}]);const t=document.createElement("div");this._menuElement=t,this.setPrivate("menuElement",this._menuElement);const e=document.createElement("a");this._iconElement=e,this._listElement=document.createElement("ul"),this._listElement.setAttribute("role","menu"),this.setPrivate("listElement",this._listElement),this._applyClassNames(),e.innerHTML='<svg fill="none" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z"/></svg>',e.setAttribute("tabindex",this._root.tabindex.toString()),e.setAttribute("aria-label",this._t("Export")+"; "+this._t("Press ENTER to open")),e.setAttribute("role","button"),h.be("keyboardevents")&&this._disposers.push(h.Oo(document,"keydown",i=>{if(document.activeElement==this._iconElement||this.isOpen)if(27==i.keyCode)this.close();else if(13==i.keyCode)this._activeItem?this._handleClick(this._activeItem):this.toggle();else if(38==i.keyCode||40==i.keyCode){const o=this.get("items",[]);let a=o.indexOf(this._activeItem);"top"==this.get("valign")&&-1==a&&(a=o.length);const n=38==i.keyCode?-1:1;let r,d=a+n;do{d<0?d=o.length-1:d>o.length-1&&(d=0),"separator"==o[d].type?d+=n:r=o[d]}while(!r);r&&this._handleItemFocus(r)}})),this._disposers.push(h.Oo(e,"click",i=>{i.stopImmediatePropagation(),this.toggle()})),t.appendChild(this._iconElement),t.appendChild(this._listElement);const s=this.get("container",this._root._inner);s.appendChild(this._menuElement),this._disposers.push(h.Oo(t,h.FL("pointerover"),i=>{this._isOver=!0,this.get("deactivateRoot")&&(this._root._renderer.interactionsEnabled=!1)})),this._disposers.push(h.Oo(t,h.FL("pointerout"),i=>{this.get("deactivateRoot")&&(this.isOpen||this._isOver)&&(this._root._renderer.interactionsEnabled=!0),this._isOver=!1})),this._disposers.push(new L.ku(()=>{this._menuElement&&s.removeChild(this._menuElement)})),this._disposers.push(h.Oo(document,"click",i=>{this.isOpen&&!this._isOver&&this.close()})),this.loadDefaultCSS(),this._root.addDisposer(this),this.events.dispatch("menucreated",{type:"menucreated",target:this})}_afterChanged(){if(super._afterChanged(),0==this._itemElements.length&&this.createItems(),this.isDirty("useDefaultCSS")&&(this.get("useDefaultCSS")?this.loadDefaultCSS():this._cssDisposer&&this._cssDisposer.dispose()),this.isDirty("exporting")&&this.get("exporting")&&this.createItems(),(this.isDirty("align")||this.isDirty("valign"))&&this._applyClassNames(),this.isDirty("container")){const t=this.get("container");t&&t.appendChild(this._menuElement)}}_dispose(){super._dispose(),_.S6(this._itemDisposers,t=>{t.dispose()})}_applyClassNames(){const t=this.get("align","right"),e=this.get("valign","top");this._menuElement.className="am5exporting am5exporting-menu am5exporting-align-"+t+" am5exporting-valign-"+e+" "+(this.isOpen?"am5exporting-menu-open":"am5exporting-menu-closed"),this._iconElement.className="am5exporting am5exporting-icon am5exporting-align-"+t+" am5exporting-valign-"+e,this._listElement.className="am5exporting am5exporting-list am5exporting-align-"+t+" am5exporting-valign-"+e}createItems(){const t=this.get("exporting");if(!t)return;this._listElement.innerHTML="",this._itemElements=[];const e=this.get("items",[]),s=t.supportedFormats(),i=t.supportedExportTypes();_.S6(this._itemDisposers,o=>{o.dispose()}),this._itemDisposers.length=0,_.S6(e,o=>{if(o.format&&-1==s.indexOf(o.format)||o.exportType&&-1==i.indexOf(o.exportType))return;const a=document.createElement("li");a.setAttribute("role","menuitem"),a.className="am5exporting am5exporting-item am5exporting-type-"+o.type,o.format&&(a.className+=" am5exporting-format-"+o.format);const n=document.createElement("a");let d=this._t("Export");o.label&&(n.innerHTML=o.label,d+=" "+o.label),o.sublabel&&(n.innerHTML+=' <span class="am5exporting-label-alt">'+o.sublabel+"</span>",d+=" ("+o.sublabel+")"),o.callback?(this._itemDisposers.push(h.Oo(n,"click",r=>{o.callback.call(o.callbackTarget||this)})),n.setAttribute("tabindex",this._root.tabindex.toString())):o.format&&t&&(this._itemDisposers.push(h.Oo(n,"click",r=>{this._handleClick(o)})),this._itemDisposers.push(h.Oo(n,"focus",r=>{this._handleItemFocus(o)})),this._itemDisposers.push(h.Oo(n,"blur",r=>{this._handleItemBlur(o)})),n.setAttribute("tabindex",this._root.tabindex.toString()),n.setAttribute("aria-label",d)),o.element=n,a.appendChild(n),this._listElement.appendChild(a),this._itemElements.push(a)})}_handleClick(t){const e=this.get("exporting");this.get("autoClose")&&this.close(),"print"==t.format?e.print():e.download(t.format)}_handleItemFocus(t){t!=this._activeItem&&(this._activeItem&&(this._activeItem.element.className=""),this._activeItem=t,t.element.className="am5exporting-item-active",t.element.focus())}_handleItemBlur(t){t.element.className="",t==this._activeItem&&(this._activeItem=void 0),this.setTimeout(()=>{(!document.activeElement||!h.r3(this.get("container"),document.activeElement))&&this.close()},10)}loadDefaultCSS(){const t=function z(g,t,e){const s=t.interfaceColors;if(!k){const i=new L.FV([new h.u0(g,".am5exporting-menu",{color:s.get("secondaryButtonText").toCSS(),"font-size":"0.8em"}),new h.u0(g,".am5exporting-menu *",{"box-sizing":"border-box",transition:"all 100ms ease-in-out"}),new h.u0(g,".am5exporting-menu a",{display:"block",cursor:"pointer"}),new h.u0(g,".am5exporting-type-separator",{color:s.get("disabled").toCSS(),"border-bottom":"1px solid "+s.get("secondaryButtonDown").toCSS()}),new h.u0(g,".am5exporting-label-alt",{color:s.get("disabled").toCSS(),"font-size":"0.8em"}),new h.u0(g,".am5exporting-menu .am5exporting-type-separator a",{cursor:"default"}),new h.u0(g,".am5exporting-menu .am5exporting-type-separator a:hover",{background:"initial"}),new h.u0(g,".am5exporting-menu",{position:"absolute","z-index":"10"}),new h.u0(g,".am5exporting-icon",{width:"30px",height:"26px",position:"absolute",margin:"5px",padding:"3px 5px","border-radius":"3px",opacity:"0.5",background:"rgba(255, 255, 255, 0.001)","background-opacity":"0"}),new h.u0(g,".am5exporting-icon:focus, .am5exporting-icon:hover, .am5exporting-menu-open .am5exporting-icon",{background:s.get("secondaryButtonHover").toCSS(),opacity:"1"}),new h.u0(g,".am5exporting-menu path",{fill:s.get("secondaryButtonText").toCSS()}),new h.u0(g,".am5exporting-list",{display:"none","list-style":"none","list-style-type":"none",margin:"5px",background:s.get("secondaryButton").toCSS(),padding:"5px 0",border:"1px solid "+s.get("secondaryButtonStroke").toCSS(),"border-radius":"3px"}),new h.u0(g,".am5exporting-menu-open .am5exporting-list",{display:"block"}),new h.u0(g,".am5exporting-item",{}),new h.u0(g,".am5exporting-item a",{padding:"3px 15px"}),new h.u0(g,".am5exporting-item a:hover, .am5exporting-item a.am5exporting-item-active",{background:s.get("secondaryButtonHover").toCSS()}),new h.u0(g,".am5exporting-menu.am5exporting-align-left, .am5exporting-icon.am5exporting-align-left, .am5exporting-list.am5exporting-align-left",{left:"0"}),new h.u0(g,".am5exporting-menu.am5exporting-align-right, .am5exporting-icon.am5exporting-align-right, .am5exporting-list.am5exporting-align-right",{right:"0"}),new h.u0(g,".am5exporting-menu.am5exporting-valign-top, .am5exporting-icon.am5exporting-valign-top, .am5exporting-list.am5exporting-align-top",{top:"0"}),new h.u0(g,".am5exporting-menu.am5exporting-valign-bottom, .am5exporting-icon.am5exporting-valign-bottom, .am5exporting-list.am5exporting-align-bottom",{bottom:"0"}),new h.u0(g,".am5exporting-list.am5exporting-align-left",{"margin-left":"40px"}),new h.u0(g,".am5exporting-list.am5exporting-align-right",{"margin-right":"40px"})]);k=new L.DM(()=>{k=void 0,i.dispose()})}return k.increment()}(h.Ay(this._root.dom),this._root);this._disposers.push(t),this._cssDisposer=t}open(){this.isOpen=!0,this._applyClassNames(),this.events.dispatch("menuopened",{type:"menuopened",target:this})}close(){this.isOpen=!1,this.get("deactivateRoot")&&(this._root._renderer.interactionsEnabled=!0),h.yv(),this._applyClassNames(),this.events.dispatch("menuclosed",{type:"menuclosed",target:this})}toggle(){this.isOpen?this.close():this.open()}}Object.defineProperty(T,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ExportingMenu"}),Object.defineProperty(T,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:O.JH.classNames.concat([T.className])});var V=b(38489),X=b(94808),A=b(49648);class P extends O.JH{constructor(){super(...arguments),Object.defineProperty(this,"_container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_picture",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_markerArea",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_skipRender",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){super._afterNew(),this._setRawDefault("layer",1e3),this._root.addDisposer(this)}_beforeChanged(){super._beforeChanged(),this.isDirty("markerState")&&this._renderState()}open(){return(0,m.mG)(this,void 0,void 0,function*(){this.setTimeout(()=>{this._root._renderer.interactionsEnabled=!1},100);const t=yield this.getMarkerArea();t.show(),this._picture.hide(0),this.get("markerState")&&t.restoreState(this.get("markerState"))})}_renderState(){return(0,m.mG)(this,void 0,void 0,function*(){const t=yield this.getMarkerArea();this.get("markerState")&&(this._skipRender=!0,t.renderState(this.get("markerState")))})}close(){return(0,m.mG)(this,void 0,void 0,function*(){(yield this.getMarkerArea()).close()})}cancel(){return(0,m.mG)(this,void 0,void 0,function*(){this._root._renderer.interactionsEnabled=!0;const t=yield this.getMarkerArea();this._picture.show(0),t.cancel()})}clear(){this.set("markerState",void 0),this._picture&&this._picture.set("src","")}toggle(){return(0,m.mG)(this,void 0,void 0,function*(){(yield this.getMarkerArea()).isOpen?this.close():this.open()})}dispose(){super.dispose(),this._markerArea&&this._markerArea.isOpen&&this._markerArea.close()}_maybeInit(){return(0,m.mG)(this,void 0,void 0,function*(){if(this._container||(this._container=this._root.container.children.push(V.W.new(this._root,{width:A.AQ,height:A.AQ,layer:this.get("layer"),interactiveChildren:!1})),this._picture=this._container.children.push(X.t.new(this._root,{width:A.AQ,height:A.AQ}))),!this._markerArea){const t=yield this._getMarkerJS(),e=this._container._display.getCanvas(),s=new t.MarkerArea(e);s.uiStyleSettings.logoPosition="right",s.uiStyleSettings.zIndex=20,s.targetRoot=e.parentElement,this._disposers.push(h.Oo(s,"close",()=>{this._root._renderer.interactionsEnabled=!0,this._picture.show(0)})),this._disposers.push(h.Oo(s,"render",i=>{this._picture.set("src",i.dataUrl),this._skipRender||this.set("markerState",i.state),this._skipRender=!1})),this._markerArea=s}})}_getMarkerJS(){return(0,m.mG)(this,void 0,void 0,function*(){return yield b.e(4384).then(b.bind(b,4010))})}getMarkerArea(){return(0,m.mG)(this,void 0,void 0,function*(){return yield this._maybeInit(),this._markerArea})}}Object.defineProperty(P,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Annotator"}),Object.defineProperty(P,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:O.JH.classNames.concat([P.className])})}}]);