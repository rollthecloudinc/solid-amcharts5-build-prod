(self.webpackChunkplugin_amcharts5=self.webpackChunkplugin_amcharts5||[]).push([[9257],{99545:(k,U)=>{function r(u){return u.replace(/[-[\]/{}()*+?.\\^$]/g,"\\$&")}function x(u,d){var y=(void 0===d?{}:d).decimalMark,g=void 0===y?".":y;if("number"==typeof u)return u.toString();if("string"!=typeof u)return"NaN";var _=r(g),b=u.trim(),D=b.match(/^\(.*\)$|^-/),M=new RegExp("[^\\d"+_+"]|"+_+"(?=.*"+_+")|^\\D*"+_+"\\D*$","g");return""===(b=b.replace(M,"").replace(g,"."))?b="NaN":D&&(b="-"+b),b}U.He=void 0,U.He=function O(u,d){var y=(void 0===d?{}:d).decimalMark,_=x(u,{decimalMark:void 0===y?".":y});return"NaN"===_?NaN:Number(_)}},29257:(k,U,p)=>{p.r(U),p.d(U,{ATTRIBUTE_WIDGET:()=>M,Attribute:()=>v,AttributeMatcherService:()=>F,AttributePipe:()=>S,AttributeSerializerService:()=>j,AttributeTypes:()=>o,AttributeValue:()=>h,AttributeWidget:()=>N,AttributeWidgetComponent:()=>w,AttributesBuilderComponent:()=>f,AttributesModule:()=>L,ValueComputerService:()=>B,WidgetPluginManager:()=>C,WidgetsService:()=>E});var r=p(56718),x=p(94055),O=p(3267),a=p(47405),G=p(95577),R=p(84945),u=p(97457),d=p(97729),c=p(30972),y=p(26073),g=p(99545);function _(i,s){}function b(i,s){if(1&i&&(r.\u0275\u0275elementStart(0,"div",4),r.\u0275\u0275element(1,"classifieds-ui-attribute-widget",5),r.\u0275\u0275elementEnd()),2&i){const e=s.index,t=r.\u0275\u0275nextContext();r.\u0275\u0275propertyInterpolate("formGroupName",e),r.\u0275\u0275advance(1),r.\u0275\u0275property("attribute",t.attributes[e])("widget",t.discoverWidget(t.attributes[e].widget))("appearance",t.appearance)}}function D(i,s){1&i&&(r.\u0275\u0275elementStart(0,"div")(1,"p"),r.\u0275\u0275text(2,"No attributes available for ad type. Click next to continue."),r.\u0275\u0275elementEnd()())}const M=new r.InjectionToken("AttributeWidget");let E=(()=>{class i{constructor(e){this.widgets=e}get(e){return this.widgets.find(t=>t.name===e)}static#e=this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275inject(M))};static#t=this.\u0275prov=r.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac})}return i})(),C=(()=>{class i extends u.BasePluginManager{constructor(e,t){super(e,t)}pluginDef(){return(0,R.of)(new u.PluginDef({name:"widget"}))}static#e=this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275inject(u.PluginConfigurationManager),r.\u0275\u0275inject(d.ModuleLoaderService))};static#t=this.\u0275prov=r.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),V=(()=>{class i{constructor(e){this.viewContainerRef=e}static#e=this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275directiveInject(r.ViewContainerRef))};static#t=this.\u0275dir=r.\u0275\u0275defineDirective({type:i,selectors:[["","classifiedsUiWidgetHost",""]]})}return i})(),w=(()=>{class i{constructor(e,t){this.componentFactoryResolver=e,this.controlContainer=t,this.appearance="legacy"}ngOnInit(){this.widget.subscribe(e=>{const t=this.componentFactoryResolver.resolveComponentFactory(e.component),n=this.widgetHost.viewContainerRef;n.clear();const l=n.createComponent(t);l.instance.attribute=this.attribute,l.instance.appearance=this.appearance})}static#e=this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275directiveInject(r.ComponentFactoryResolver),r.\u0275\u0275directiveInject(a.ControlContainer))};static#t=this.\u0275cmp=r.\u0275\u0275defineComponent({type:i,selectors:[["classifieds-ui-attribute-widget"]],viewQuery:function(t,n){if(1&t&&r.\u0275\u0275viewQuery(V,7),2&t){let l;r.\u0275\u0275queryRefresh(l=r.\u0275\u0275loadQuery())&&(n.widgetHost=l.first)}},inputs:{widget:"widget",attribute:"attribute",appearance:"appearance"},decls:2,vars:1,consts:[[3,"formGroup"],["classifiedsUiWidgetHost",""]],template:function(t,n){1&t&&(r.\u0275\u0275elementContainerStart(0,0),r.\u0275\u0275template(1,_,0,0,"ng-template",1),r.\u0275\u0275elementContainerEnd()),2&t&&r.\u0275\u0275property("formGroup",n.controlContainer.control)},dependencies:[a.NgControlStatusGroup,a.FormGroupDirective,V]})}return i})(),f=(()=>{class i{set attributeValues(e){this._attributeValues=e,this.applyValues()}get attributeValues(){return this._attributeValues}get attributesArray(){return this.attributesForm.get("attributes")}constructor(e,t){this.widgetsService=e,this.wpm=t,this.attributes=[],this.appearance="legacy",this.attributesForm=new a.UntypedFormGroup({attributes:new a.UntypedFormArray([])}),this._attributeValues=[],this.onTouched=()=>{}}ngOnChanges(e){if(e.attributes&&(!e.attributes.previousValue||e.attributes.previousValue!==e.attributes.currentValue)){for(;0!==this.attributesArray.length;)this.attributesArray.removeAt(0);this.attributes.forEach(t=>{this.attributesArray.push(new a.UntypedFormGroup({name:new a.UntypedFormControl(t.name,a.Validators.required),type:new a.UntypedFormControl(t.type,a.Validators.required),displayName:new a.UntypedFormControl(t.label,a.Validators.required),value:new a.UntypedFormControl("",t.required?a.Validators.required:[]),attributes:new a.UntypedFormArray(t.attributes?t.attributes.map(n=>new a.UntypedFormGroup({name:new a.UntypedFormControl(n.name,a.Validators.required),type:new a.UntypedFormControl(n.type,a.Validators.required),displayName:new a.UntypedFormControl(n.label,a.Validators.required),value:new a.UntypedFormControl("",n.required?a.Validators.required:[])})):[])}))}),this.applyValues()}}writeValue(e){e&&(console.log(`write value: ${e}`),this.attributesArray.setValue(e,{emitEvent:!1}))}registerOnChange(e){this.attributesArray.valueChanges.subscribe(e)}registerOnTouched(e){this.onTouched=e}setDisabledState(e){e?this.attributesArray.disable():this.attributesArray.enable()}validate(e){return this.attributesForm.valid?null:{invalidForm:{valid:!1,message:"attributes are invalid"}}}discoverWidget(e){return this.wpm.getPlugin(e)}applyValues(){this.attributesArray.controls.forEach((e,t)=>{const n=this.attributeValues?this.attributeValues.find(l=>l.name===e.get("name").value):void 0;void 0!==n&&(e.get("value").setValue(n.value),e.updateValueAndValidity()),e.get("attributes").controls.forEach(l=>{const m=this.attributeValues&&void 0!==this.attributeValues[t]?this.attributeValues[t].attributes.find(I=>I.name===l.get("name").value):void 0;void 0!==m&&(l.get("value").setValue(m.value),l.updateValueAndValidity())})})}static#e=this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275directiveInject(E),r.\u0275\u0275directiveInject(C))};static#t=this.\u0275cmp=r.\u0275\u0275defineComponent({type:i,selectors:[["classifieds-ui-attributes-builder"]],inputs:{attributes:"attributes",appearance:"appearance",attributeValues:"attributeValues"},features:[r.\u0275\u0275ProvidersFeature([E,{provide:a.NG_VALUE_ACCESSOR,useExisting:(0,r.forwardRef)(()=>i),multi:!0},{provide:a.NG_VALIDATORS,useExisting:(0,r.forwardRef)(()=>i),multi:!0}]),r.\u0275\u0275NgOnChangesFeature],decls:4,vars:3,consts:[[3,"formGroup"],["formArrayName","attributes",1,"attribute-fields"],["class","attribute-field-container",3,"formGroupName",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"attribute-field-container",3,"formGroupName"],[3,"attribute","widget","appearance"]],template:function(t,n){1&t&&(r.\u0275\u0275elementContainerStart(0,0),r.\u0275\u0275elementStart(1,"div",1),r.\u0275\u0275template(2,b,2,4,"div",2),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd(),r.\u0275\u0275template(3,D,3,0,"div",3)),2&t&&(r.\u0275\u0275property("formGroup",n.attributesForm),r.\u0275\u0275advance(2),r.\u0275\u0275property("ngForOf",n.attributesArray.controls),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngIf",0==n.attributes.length))},dependencies:[x.NgForOf,x.NgIf,a.NgControlStatusGroup,a.FormGroupDirective,a.FormGroupName,a.FormArrayName,w]})}return i})(),A=(()=>{class i{constructor(e){this.controlContainer=e,this.appearance="legacy"}static#e=this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275directiveInject(a.ControlContainer))};static#t=this.\u0275cmp=r.\u0275\u0275defineComponent({type:i,selectors:[["classifieds-ui-text-widget"]],inputs:{attribute:"attribute",appearance:"appearance"},decls:3,vars:3,consts:[[3,"formGroup"],[3,"appearance"],["matInput","","formControlName","value",3,"placeholder"]],template:function(t,n){1&t&&(r.\u0275\u0275elementContainerStart(0,0),r.\u0275\u0275elementStart(1,"mat-form-field",1),r.\u0275\u0275element(2,"input",2),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd()),2&t&&(r.\u0275\u0275property("formGroup",n.controlContainer.control),r.\u0275\u0275advance(1),r.\u0275\u0275property("appearance",n.appearance),r.\u0275\u0275advance(1),r.\u0275\u0275property("placeholder",n.attribute.label))},dependencies:[a.DefaultValueAccessor,a.NgControlStatus,a.NgControlStatusGroup,a.FormGroupDirective,a.FormControlName,c.MatLegacyFormField,y.MatLegacyInput]})}return i})(),P=(()=>{class i{constructor(e){this.controlContainer=e}static#e=this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275directiveInject(a.ControlContainer))};static#t=this.\u0275cmp=r.\u0275\u0275defineComponent({type:i,selectors:[["classifieds-ui-min-max-widget"]],inputs:{attribute:"attribute"},decls:8,vars:4,consts:[[3,"formGroup"],["formArrayName","attributes"],["formGroupName","0"],["matInput","","type","number","formControlName","value",3,"placeholder"],["formGroupName","1"]],template:function(t,n){1&t&&(r.\u0275\u0275elementContainerStart(0,0),r.\u0275\u0275elementStart(1,"label"),r.\u0275\u0275text(2),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(3,"div",1)(4,"mat-form-field",2),r.\u0275\u0275element(5,"input",3),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(6,"mat-form-field",4),r.\u0275\u0275element(7,"input",3),r.\u0275\u0275elementEnd()(),r.\u0275\u0275elementContainerEnd()),2&t&&(r.\u0275\u0275property("formGroup",n.controlContainer.control),r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate(n.attribute.label),r.\u0275\u0275advance(3),r.\u0275\u0275property("placeholder",n.attribute.attributes[0].label),r.\u0275\u0275advance(2),r.\u0275\u0275property("placeholder",n.attribute.attributes[1].label))},dependencies:[a.DefaultValueAccessor,a.NumberValueAccessor,a.NgControlStatus,a.NgControlStatusGroup,a.FormGroupDirective,a.FormControlName,a.FormGroupName,a.FormArrayName,c.MatLegacyFormField,y.MatLegacyInput]})}return i})(),F=(()=>{class i{getComputedValue(e,t){const n=t&&t.length>0&&this.matchAttribute(e,t);if(n)return n.computedValue}getValue(e,t){const n=t&&t.length>0&&this.matchAttribute(e,t);if(n)return n.value}matchAttribute(e,t){const n=t.length;for(let l=0;l<n;l++)if(t[l].attributes&&t[l].attributes.length>0){if(this.matchAttribute(e,t[l].attributes))return t[l]}else if(e===t[l].name)return t[l]}static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275prov=r.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),S=(()=>{class i{constructor(e){this.attributeMatcher=e}transform(e,t){return this.attributeMatcher.getComputedValue(t,e)||""}static#e=this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275directiveInject(F,16))};static#t=this.\u0275pipe=r.\u0275\u0275definePipe({name:"attribute",type:i,pure:!0})}return i})();var o=(()=>((o=o||{})[o.Number=0]="Number",o[o.Text=1]="Text",o[o.Complex=2]="Complex",o[o.Float=3]="Float",o[o.Array=4]="Array",o[o.Bool=5]="Bool",o[o.Date=6]="Date",o))();class N extends u.Plugin{constructor(s){super(s),s&&(this.name=this.id,this.schema=s.schema?new v(s.schema):void 0,this.component=s.component)}}class v{constructor(s){this.attributes=[],s&&(this.name=s.name,this.widget=void 0!==s.widget?s.widget:"text",this.type=s.type,this.label=s.label,this.required=s.required,this.options=s.options,s.attributes&&(this.attributes=s.attributes.map(e=>new v(e))))}}class h{constructor(s){this.attributes=[],s&&(this.name=s.name,this.displayName=s.displayName,this.type=s.type,this.value=s.value,this.intValue=s.intValue,this.computedValue=s.computedValue,s.attributes&&(Array.isArray(s.attributes)?this.attributes=s.attributes.reduce((e,t)=>void 0===t._store||t._store?[...e,new h(t)]:e,[]):(void 0===s.attributes._store||s.attributes._store)&&(this.attributes=[s.attributes])),s.value&&"object"==typeof s.value?(this.value=void 0,this.type=o.Complex,s.value.attributes.reduce((e,t)=>void 0===t._store||t._store?[...e,new h(t)]:e,[])):this.value=s.value)}}const T=()=>{const i=new v({name:"",type:o.Text,label:"",required:!1,widget:"text",options:{},attributes:[]});return new N({id:"text",name:"text",title:"Text",component:A,schema:i})},W=()=>new N({id:"minmax",name:"minmax",title:"MinMax",component:P,schema:void 0});let L=(()=>{class i{constructor(e,t){e.forEach(n=>t.register(n))}static#e=this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275inject(M),r.\u0275\u0275inject(C))};static#t=this.\u0275mod=r.\u0275\u0275defineNgModule({type:i});static#r=this.\u0275inj=r.\u0275\u0275defineInjector({providers:[{provide:M,useFactory:T,multi:!0},{provide:M,useFactory:W,multi:!0}],imports:[x.CommonModule,a.ReactiveFormsModule,G.MaterialModule,O.HttpClientJsonpModule]})}return i})(),B=(()=>{class i{constructor(){}compute(e){const t=[];return e.forEach(n=>t.push(this.computeAttribute(n))),t}computeAttribute(e){const t=this.resolveComputedValue(e.value,e.type);return new h(e.attributes&&e.attributes.length>0?{...e,computedValue:t,attributes:this.compute(e.attributes)}:{...e,computedValue:t})}resolveComputedValue(e,t){let n;return t===o.Number?(n=(0,g.He)(e.trim()),n&&isNaN(n)&&(n=void 0)):n=e.trim(),void 0===n?n:`${n}`}static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275prov=r.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),j=(()=>{class i{constructor(e){this.valueComputer=e}serialize(e,t){const n=typeof e;if("object"!==n)return new h({name:t,type:"string"!==n?"boolean"!==n?o.Number:o.Bool:o.Text,displayName:t,value:`${e}`,intValue:void 0,computedValue:this.valueComputer.resolveComputedValue(`${e}`,"string"!==n?"boolean"!==n?o.Number:o.Bool:o.Text),attributes:[]});if(Array.isArray(e)&&("attributes"===t||"settings"===t))return new h({name:t,type:o.Complex,displayName:t,value:void 0,intValue:void 0,computedValue:void 0,attributes:e});if(Array.isArray(e)){const l=e.length,m=[];for(let I=0;I<l;I++)m.push(this.serialize(e[I],`${I}`));return new h({name:t,type:o.Array,displayName:t,value:void 0,intValue:void 0,computedValue:void 0,attributes:m})}if(e instanceof Date)return new h({name:t,type:o.Date,displayName:t,value:e.toJSON(),intValue:void 0,computedValue:e.toJSON(),attributes:[]});{const l=[];for(const m in e)l.push(this.serialize(e[m],m));return new h({name:t,type:o.Complex,displayName:t,value:void 0,intValue:void 0,computedValue:void 0,attributes:l})}}deserializeAsObject(e,t=!1){return this.deserialize(new h({name:"root",type:o.Complex,displayName:"root",value:void 0,computedValue:void 0,intValue:0,attributes:e}),t)}deserialize(e,t=!1){let n,l;switch(e.type){case o.Complex:if(t||"attributes"!==e.name&&"settings"!==e.name){l=e.attributes.length;for(let m=0;m<l;m++)n={...n,[e.attributes[m].name]:this.deserialize(e.attributes[m])}}else n=e.attributes.map(m=>new h(m));break;case o.Bool:n=void 0!==e.value?["1","true","on"].findIndex(m=>m===e.value)>-1:void 0;break;case o.Number:case o.Float:n=void 0!==e.value&&""!==e.value&&"undefined"!==e.value?"0"!==e.value?(0,g.He)(e.value.trim()):0:void 0;break;case o.Text:n=e.value;break;case o.Array:if(t||"attributes"!==e.name&&"settings"!==e.name){l=e.attributes.length,n=[];for(let m=0;m<l;m++)n=[...n,this.deserialize(e.attributes[m])]}else n=e.attributes.map(m=>new h(m));break;case o.Date:n=void 0!==e.value&&""!==e.value?new Date(e.value):void 0}return n}convertToGroup(e){const t=new a.UntypedFormGroup({name:new a.UntypedFormControl(e.name,a.Validators.required),type:new a.UntypedFormControl(e.type,a.Validators.required),displayName:new a.UntypedFormControl(e.displayName,a.Validators.required),value:new a.UntypedFormControl(e.value,a.Validators.required),computedValue:new a.UntypedFormControl(e.value,a.Validators.required),attributes:new a.UntypedFormArray([])});return e.attributes&&e.attributes.length>0&&e.attributes.forEach(n=>{t.get("attributes").push(this.convertToGroup(n))}),t}static#e=this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275inject(B))};static#t=this.\u0275prov=r.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()}}]);