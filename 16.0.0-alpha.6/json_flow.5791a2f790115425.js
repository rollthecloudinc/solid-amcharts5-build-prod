(self.webpackChunkplugin_amcharts5=self.webpackChunkplugin_amcharts5||[]).push([[9402],{6905:(Me,me,T)=>{T.d(me,{c:()=>ye});var le=T(50886),F=T(71765),j=T(43933),pe=T(53962);class ye extends pe.A{_beforeChanged(){super._beforeChanged(),(this.isDirty("cornerRadiusTL")||this.isDirty("cornerRadiusTR")||this.isDirty("cornerRadiusBR")||this.isDirty("cornerRadiusBL"))&&(this._clear=!0)}_draw(){let ge=this.width(),V=this.height(),K=ge,Y=V,Q=K/Math.abs(ge),J=Y/Math.abs(V);if(le.hj(K)&&le.hj(Y)){let ue=Math.min(K,Y)/2,B=j.Iy(this.get("cornerRadiusTL",8),ue),N=j.Iy(this.get("cornerRadiusTR",8),ue),se=j.Iy(this.get("cornerRadiusBR",8),ue),I=j.Iy(this.get("cornerRadiusBL",8),ue),de=Math.min(Math.abs(K/2),Math.abs(Y/2));B=F.C7(B,0,de),N=F.C7(N,0,de),se=F.C7(se,0,de),I=F.C7(I,0,de);const D=this._display;D.moveTo(B*Q,0),D.lineTo(K-N*Q,0),N>0&&D.arcTo(K,0,K,N*J,N),D.lineTo(K,Y-se*J),se>0&&D.arcTo(K,Y,K-se*Q,Y,se),D.lineTo(I*Q,Y),I>0&&D.arcTo(0,Y,0,Y-I*J,I),D.lineTo(0,B*J),B>0&&D.arcTo(0,0,B*Q,0,B),D.closePath()}}}Object.defineProperty(ye,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RoundedRectangle"}),Object.defineProperty(ye,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:pe.A.classNames.concat([ye.className])})},86108:(Me,me,T)=>{T.d(me,{Chord:()=>De,ChordDirected:()=>qe,ChordLink:()=>Ne,ChordLinkDirected:()=>Xe,ChordNodes:()=>Ke,ChordNonRibbon:()=>et,Flow:()=>J,FlowLink:()=>xe,FlowNode:()=>Ze,FlowNodes:()=>_e,Sankey:()=>it,SankeyLink:()=>Ve,SankeyNodes:()=>Ue});var le=T(84911),F=T(57333),j=T(49648),pe=T(11754),ye=T(98357),U=T(15784);class ge extends F.Q{setupDefaultRules(){super.setupDefaultRules();const t=this._root.interfaceColors,e=this.rule.bind(this);e("Flow").setAll({width:j.AQ,height:j.AQ,paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10}),e("FlowNodes").setAll({colors:pe.U.new(this._root,{}),legendLabelText:"{name}",legendValueText:"{sumOutgoing.formatNumber('#.#')}"}),e("FlowNode").setAll({}),e("FlowNode",["unknown"]).setAll({draggable:!1,opacity:0}),e("RadialLabel",["flow","node"]).setAll({text:"{name}",populateText:!0}),e("FlowLink").setAll({fillStyle:"gradient",strokeStyle:"gradient"}),e("FlowLink",["source","unknown"]).setAll({}),e("FlowLink",["target","unknown"]).setAll({}),e("FlowNode").events.on("pointerover",i=>{const a=i.target.dataItem;if(a){const o=a.get("outgoingLinks");o&&U.S6(o,u=>{const b=u.get("link");b.hover(),b.hideTooltip()});const l=a.get("incomingLinks");l&&U.S6(l,u=>{const b=u.get("link");b.hover(),b.hideTooltip()})}let s=a.get("slice")||a.get("rectangle");s&&s.get("tooltipText")&&s.showTooltip()}),e("FlowNode").events.on("pointerout",i=>{const a=i.target.dataItem;if(a){const s=a.get("outgoingLinks");s&&U.S6(s,l=>{l.get("link").unhover()});const o=a.get("incomingLinks");o&&U.S6(o,l=>{l.get("link").unhover()})}}),e("Sankey").setAll({orientation:"horizontal",nodeAlign:"justify",linkTension:.5,nodePadding:10,nodeWidth:10}),e("RoundedRectangle",["sankey","node","shape"]).setAll({cornerRadiusTL:0,cornerRadiusBL:0,cornerRadiusTR:0,cornerRadiusBR:0}),e("SankeyLink").setAll({controlPointDistance:.2}),e("FlowNode",["sankey"]).setAll({draggable:!0});{const i=e("Graphics",["sankey","link"]);i.setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0,tooltipText:"{sourceId} - {targetId}: {value}"}),(0,ye.v)(i,"fill",t,"grid")}e("Graphics",["sankey","link"]).states.create("hover",{fillOpacity:.5}),e("Label",["sankey","node"]).setAll({text:"{name}",populateText:!0}),e("Label",["sankey","horizontal"]).setAll({y:j.CI,centerY:j.CI,paddingLeft:15}),e("Label",["sankey","vertical"]).setAll({x:j.CI,centerX:j.CI,paddingTop:15}),e("Chord").setAll({radius:(0,j.aQ)(90),nodeWidth:10,padAngle:1,startAngle:0,sort:"descending"}),e("ChordDirected").setAll({linkHeadRadius:10}),e("ChordNodes").setAll({x:j.CI,y:j.CI}),e("FlowNode",["chord"]).setAll({draggable:!0}),e("ChordLink").setAll({sourceRadius:j.AQ,targetRadius:j.AQ,fillStyle:"solid",strokeStyle:"solid",tooltipText:"{sourceId} - {targetId}: {value}"}),e("Slice",["chord","node","shape"]).setAll({cornerRadius:0}),e("RadialLabel",["chord","node"]).setAll({radius:5,textType:"circular"}),e("ChordLinkDirected").setAll({headRadius:10});{const i=e("Graphics",["chord","link","shape"]);i.setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0}),(0,ye.v)(i,"fill",t,"grid"),(0,ye.v)(i,"stroke",t,"grid")}e("Graphics",["chord","link","shape"]).states.create("hover",{fillOpacity:.5}),e("ChordNonRibbon").setAll({linkType:"curve"}),e("ChordLink",["basic"]).setAll({fillStyle:"none",strokeStyle:"source"}),e("Graphics",["chord","link","shape","basic"]).setAll({strokeOpacity:.4}),e("Graphics",["chord","link","shape","basic"]).states.create("hover",{strokeWidth:2,strokeOpacity:1})}}var V=T(19037),K=T(38489),Y=T(78826),Q=T(50886);class J extends V.F{constructor(){super(...arguments),Object.defineProperty(this,"linksContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(K.W.new(this._root,{}))}),Object.defineProperty(this,"_nodesData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_linksData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_index",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_nodesDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_linksByIndex",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._defaultThemes.push(ge.new(this._root)),this.fields.push("disabled","sourceId","targetId"),this.nodes&&(this.nodes.flow=this),super._afterNew(),this.children.push(this.bulletsContainer)}processDataItem(t){super.processDataItem(t);const e=this.nodes;if(e){let i=!1,a=t.get("sourceId"),s=e.getDataItemById(a);s||(null==a&&(a="undefined"+this._index,this._index++,i=!0),e.data.push({id:a,unknown:i}),s=e.getDataItemById(a),i||s.set("name",a)),i=!1;let o=t.get("targetId"),l=e.getDataItemById(o);l||(null==o&&(o="undefined"+this._index,this._index++,i=!0),e.data.push({id:o,unknown:i}),l=e.getDataItemById(o),i||l.set("name",o)),s&&(t.set("source",s),e.addOutgoingLink(s,t)),l&&(t.set("target",l),e.addincomingLink(l,t)),t.set("link",this.makeLink(t));const u=this.nodes.dataItems.indexOf(s),b=this.nodes.dataItems.indexOf(l);this._linksByIndex[u+"_"+b]=t,s.get("unknown")&&(l&&s.set("fill",l.get("fill")),t.get("link").set("fillStyle","gradient")),l.get("unknown")&&(s&&l.set("fill",s.get("fill")),t.get("link").set("fillStyle","gradient")),this._updateLinkColor(t)}}_onDataClear(){this.nodes._userDataSet||(this.nodes.data.setAll([]),this.nodes._userDataSet=!1)}_prepareChildren(){super._prepareChildren();let t=1/0,e=-1/0,i=0;if(this._valuesDirty){this._nodesData=[];const a=this.nodes;a&&U.S6(a.dataItems,s=>{const o=s.get("d3SankeyNode");this._nodesData.push(o);const l=s.get("incomingLinks");let u=0,b=0;l&&U.S6(l,L=>{const P=L.get("value"),M=L.get("valueWorking");u+=P,b+=M}),s.set("sumIncoming",u),s.set("sumIncomingWorking",b);const v=s.get("outgoingLinks");let A=0,S=0;v&&U.S6(v,L=>{const P=L.get("value"),M=L.get("valueWorking");A+=P,S+=M}),s.set("sumOutgoing",A),s.set("sumOutgoingWorking",S),s.set("sum",u+A),s.set("sumWorking",b+S),a.updateLegendValue(s)}),this._linksData=[],U.S6(this.dataItems,s=>{let o=s.get("value");Q.hj(o)&&(o<t&&(t=o),o>e&&(e=o),i+=o)}),U.S6(this.dataItems,s=>{let o=s.get("value");if(Q.hj(o)){let l=s.get("valueWorking"),u=this.get("minSize",0);u>0&&l<u*i&&(l=u*i);let b={source:s.get("source").get("d3SankeyNode"),target:s.get("target").get("d3SankeyNode"),value:l};s.setRaw("d3SankeyLink",b),this._linksData.push(b),this.updateLegendValue(s)}}),this.setPrivateRaw("valueHigh",e),this.setPrivateRaw("valueLow",t),this.setPrivateRaw("valueSum",i)}}_updateLinkColor(t){const e=t.get("link"),i=e.get("fillStyle"),a=e.get("strokeStyle"),s=t.get("source"),o=t.get("target"),l=s.get("fill"),u=o.get("fill");switch(e.remove("fillGradient"),e.remove("strokeGradient"),i){case"solid":e._applyTemplates();break;case"source":e.set("fill",l);break;case"target":e.set("fill",u);break;case"gradient":let b=e._fillGradient;if(!b){b=Y.o.new(this._root,{});const v={color:l};s.get("unknown")&&(v.opacity=0);const A={color:u};o.get("unknown")&&(A.opacity=0),b.set("stops",[v,A]),e._fillGradient=b}e.set("fillGradient",b);break;case"none":e.set("fill",void 0)}switch(a){case"solid":e._applyTemplates();break;case"source":e.set("stroke",l);break;case"target":e.set("stroke",u);case"gradient":let b=e._strokeGradient;if(!b){b=Y.o.new(this._root,{});const v={color:l};s.get("unknown")&&(v.opacity=0);const A={color:u};o.get("unknown")&&(A.opacity=0),b.set("stops",[v,A]),e._strokeGradient=b}e.set("strokeGradient",b);break;case"none":e.remove("stroke")}}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("link");e&&(this.links.removeValue(e),e.dispose())}hideDataItem(t,e){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,le.mG)(this,void 0,void 0,function*(){const a=[i.hideDataItem.call(this,t,e)],s=this.states.create("hidden",{}),o="stateAnimationDuration",l="stateAnimationEasing";Q.hj(e)||(e=s.get(o,this.get(o,0)));const u=s.get(l,this.get(l));a.push(t.animate({key:"valueWorking",to:0,duration:e,easing:u}).waitForStop()),t.get("link").hide(),yield Promise.all(a)})}showDataItem(t,e){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,le.mG)(this,void 0,void 0,function*(){const a=[i.showDataItem.call(this,t,e)];Q.hj(e)||(e=this.get("stateAnimationDuration",0));const s=this.get("stateAnimationEasing");a.push(t.animate({key:"valueWorking",to:t.get("value"),duration:e,easing:s}).waitForStop()),t.get("link").show(),yield Promise.all(a)})}_positionBullet(t){const e=t.get("sprite");if(e){const i=e.dataItem;if(i){const a=i.get("link"),s=t.get("sprite");if(s){const o=a.getPoint(this._getBulletLocation(t));s.setAll({x:o.x,y:o.y}),t.get("autoRotate")&&s.set("rotation",o.angle+t.get("autoRotateAngle",0))}}}}_getBulletLocation(t){return t.get("locationY",0)}}Object.defineProperty(J,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Flow"}),Object.defineProperty(J,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:V.F.classNames.concat([J.className])});var ue=Math.abs,B=Math.cos,N=Math.sin,se=Math.PI,I=se/2,de=2*se,D=Math.max,ne=1e-12;function Ee(n,t){return Array.from({length:t-n},(e,i)=>n+i)}function Te(n,t){var e=0,i=null,a=null,s=null;function o(l){var P,u=l.length,b=new Array(u),v=Ee(0,u),A=new Array(u*u),S=new Array(u),L=0;l=Float64Array.from({length:u*u},t?(M,f)=>l[f%u][f/u|0]:(M,f)=>l[f/u|0][f%u]);for(let M=0;M<u;++M){let f=0;for(let p=0;p<u;++p)f+=l[M*u+p]+n*l[p*u+M];L+=b[M]=f}P=(L=D(0,de-e*u)/L)?e:de/u;{let M=0;i&&v.sort((f,p)=>i(b[f],b[p]));for(const f of v){const p=M;if(n){const x=Ee(1+~u,u).filter(m=>m<0?l[~m*u+f]:l[f*u+m]);a&&x.sort((m,w)=>a(m<0?-l[~m*u+f]:l[f*u+m],w<0?-l[~w*u+f]:l[f*u+w]));for(const m of x)m<0?(A[~m*u+f]||(A[~m*u+f]={source:null,target:null})).target={index:f,startAngle:M,endAngle:M+=l[~m*u+f]*L,value:l[~m*u+f]}:(A[f*u+m]||(A[f*u+m]={source:null,target:null})).source={index:f,startAngle:M,endAngle:M+=l[f*u+m]*L,value:l[f*u+m]};S[f]={index:f,startAngle:p,endAngle:M,value:b[f]}}else{const x=Ee(0,u).filter(m=>l[f*u+m]||l[m*u+f]);a&&x.sort((m,w)=>a(l[f*u+m],l[f*u+w]));for(const m of x){let w;if(f<m?(w=A[f*u+m]||(A[f*u+m]={source:null,target:null}),w.source={index:f,startAngle:M,endAngle:M+=l[f*u+m]*L,value:l[f*u+m]}):(w=A[m*u+f]||(A[m*u+f]={source:null,target:null}),w.target={index:f,startAngle:M,endAngle:M+=l[f*u+m]*L,value:l[f*u+m]},f===m&&(w.source=w.target)),w.source&&w.target&&w.source.value<w.target.value){const E=w.source;w.source=w.target,w.target=E}}S[f]={index:f,startAngle:p,endAngle:M,value:b[f]}}M+=P}}return(A=Object.values(A)).groups=S,s?A.sort(s):A}return o.padAngle=function(l){return arguments.length?(e=D(0,l),o):e},o.sortGroups=function(l){return arguments.length?(i=l,o):i},o.sortSubgroups=function(l){return arguments.length?(a=l,o):a},o.sortChords=function(l){return arguments.length?(null==l?s=null:(s=function Le(n){return function(t,e){return n(t.source.value+t.target.value,e.source.value+e.target.value)}}(l))._=l,o):s&&s._},o}var We=T(83374),Fe=Array.prototype.slice;function Oe(n){return function(){return n}}function Ct(n){return n.source}function Mt(n){return n.target}function ct(n){return n.radius}function Et(n){return n.startAngle}function jt(n){return n.endAngle}function Rt(){return 0}function zt(){return 10}function ht(n){var t=Ct,e=Mt,i=ct,a=ct,s=Et,o=jt,l=Rt,u=null;function b(){var v,A=t.apply(this,arguments),S=e.apply(this,arguments),L=l.apply(this,arguments)/2,P=Fe.call(arguments),M=+i.apply(this,(P[0]=A,P)),f=s.apply(this,P)-I,p=o.apply(this,P)-I,x=+a.apply(this,(P[0]=S,P)),m=s.apply(this,P)-I,w=o.apply(this,P)-I;if(u||(u=v=(0,We.ET)()),L>ne&&(ue(p-f)>2*L+ne?p>f?(f+=L,p-=L):(f-=L,p+=L):f=p=(f+p)/2,ue(w-m)>2*L+ne?w>m?(m+=L,w-=L):(m-=L,w+=L):m=w=(m+w)/2),u.moveTo(M*B(f),M*N(f)),u.arc(0,0,M,f,p),f!==m||p!==w)if(n){var z=x-+n.apply(this,arguments),re=(m+w)/2;u.quadraticCurveTo(0,0,z*B(m),z*N(m)),u.lineTo(x*B(re),x*N(re)),u.lineTo(z*B(w),z*N(w))}else u.quadraticCurveTo(0,0,x*B(m),x*N(m)),u.arc(0,0,x,m,w);if(u.quadraticCurveTo(0,0,M*B(f),M*N(f)),u.closePath(),v)return u=null,v+""||null}return n&&(b.headRadius=function(v){return arguments.length?(n="function"==typeof v?v:Oe(+v),b):n}),b.radius=function(v){return arguments.length?(i=a="function"==typeof v?v:Oe(+v),b):i},b.sourceRadius=function(v){return arguments.length?(i="function"==typeof v?v:Oe(+v),b):i},b.targetRadius=function(v){return arguments.length?(a="function"==typeof v?v:Oe(+v),b):a},b.startAngle=function(v){return arguments.length?(s="function"==typeof v?v:Oe(+v),b):s},b.endAngle=function(v){return arguments.length?(o="function"==typeof v?v:Oe(+v),b):o},b.padAngle=function(v){return arguments.length?(l="function"==typeof v?v:Oe(+v),b):l},b.source=function(v){return arguments.length?(t=v,b):t},b.target=function(v){return arguments.length?(e=v,b):e},b.context=function(v){return arguments.length?(u=v??null,b):u},b}function ft(){return ht()}function gt(){return ht(zt)}function It(n,t){return null==n||null==t?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function Gt(n,t){return null==n||null==t?NaN:t<n?-1:t>n?1:t>=n?0:NaN}T(21692);Math;function Ye(n){return{type:n}}function Be(n,t,e){this.k=n,this.x=t,this.y=e}["w","e"].map(Ye),["n","s"].map(Ye),["n","w","e","s","nw","ne","sw","se"].map(Ye),Be.prototype={constructor:Be,scale:function(n){return 1===n?this:new Be(this.k*n,this.x,this.y)},translate:function(n,t){return 0===n&0===t?this:new Be(this.k,this.x+this.k*n,this.y+this.k*t)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Be(1,0,0);var ke=T(24837),we=T(25905),en=T(88303);class Ze extends K.W{constructor(){super(...arguments),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}}Object.defineProperty(Ze,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNode"}),Object.defineProperty(Ze,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:K.W.classNames.concat([Ze.className])});class _e extends V.F{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new we.o(ke.YS.new({}),()=>en._._new(this._root,{},[this.labels.template]))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:new we.o(ke.YS.new({}),()=>Ze._new(this._root,{themeTags:["node"]},[this.nodes.template]))}),Object.defineProperty(this,"_userDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this.fields.push("unknown","name","fill"),this.set("idField","id"),this.set("nameField","id"),this.set("fillField","fill"),this.set("unknownField","unknown"),this.children.push(this.bulletsContainer),super._afterNew()}_onDataClear(){const t=this.get("colors");t&&t.reset(),this._userDataSet=!0}processDataItem(t){if(super.processDataItem(t),t.setRaw("d3SankeyNode",{name:t.get("id"),dataItem:t}),null==t.get("fill")){let e=this.get("colors");e&&t.setRaw("fill",e.next())}t.setRaw("node",this.makeNode(t))}makeNode(t,e){const i=this.nodes.make();return this.nodes.push(i),e&&i.addTag(e),t.get("unknown")&&i.addTag("unknown"),this.children.push(i),i._setDataItem(t),i.series=this,t.set("node",i),i}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("node");e&&(this.nodes.removeValue(e),e.dispose());let i=t.get("label");i&&(this.labels.removeValue(i),i.dispose())}addincomingLink(t,e){let i=t.get("incomingLinks");i||(i=[],t.set("incomingLinks",i)),i.push(e)}addOutgoingLink(t,e){let i=t.get("outgoingLinks");i||(i=[],t.set("outgoingLinks",i)),i.push(e)}showDataItem(t,e){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,le.mG)(this,void 0,void 0,function*(){const a=[i.showDataItem.call(this,t,e)],s=this.flow;if(s){let o=t.get("label");o&&o.show(e);let l=t.get("outgoingLinks");l&&U.S6(l,u=>{s.showDataItem(u,e)}),l=t.get("incomingLinks"),l&&U.S6(l,u=>{s.showDataItem(u,e)})}yield a})}hideDataItem(t,e){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,le.mG)(this,void 0,void 0,function*(){const a=[i.hideDataItem.call(this,t,e)],s=this.flow;if(s){let o=t.get("label");o&&o.hide(e);let l=t.get("outgoingLinks");l&&U.S6(l,u=>{s.hideDataItem(u,e)}),l=t.get("incomingLinks"),l&&U.S6(l,u=>{s.hideDataItem(u,e)})}yield a})}}Object.defineProperty(_e,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNodes"}),Object.defineProperty(_e,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:V.F.classNames.concat([_e.className])});var tn=T(55696),nn=T(79862),C=T(71765);class Ke extends _e{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new we.o(ke.YS.new({}),()=>nn.x._new(this._root,{},[this.labels.template]))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dAngle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:new we.o(ke.YS.new({}),()=>tn.p._new(this._root,{themeTags:["shape"]},[this.rectangles.template]))})}makeNode(t){const e=super.makeNode(t,"chord"),i=e.children.insertIndex(0,this.rectangles.make());t.set("slice",i),i._setSoft("fill",t.get("fill"));const a=this.labels.make();return this.labels.push(a),a.addTag("flow"),a.addTag("chord"),a.addTag("node"),e.children.push(a),t.set("label",a),e.events.on("dragstart",s=>{let o=this.toLocal(s.point);const l=C._O({x:0,y:0},o);this.flow&&(this._dAngle=this.flow.get("startAngle",0)-l)}),e.events.on("dragged",s=>{let o=this.toLocal(s.point);const l=C._O({x:0,y:0},o);e.setAll({x:0,y:0}),this.flow&&this.flow.set("startAngle",l+this._dAngle)}),a._setDataItem(t),i._setDataItem(t),e}_positionBullet(t){const e=t.get("sprite");if(e){const i=e.dataItem;if(i){const a=t.get("sprite");if(a){const s=i.get("slice"),o=t.get("locationX",.5),l=t.get("locationY",.5);if(s){const u=s.get("radius",0),b=s.get("innerRadius",0),v=b+(u-b)*l,A=s.get("startAngle",0)+s.get("arc",0)*o;a.setAll({x:v*C.mC(A),y:v*C.O$(A)})}}}}}}Object.defineProperty(Ke,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNodes"}),Object.defineProperty(Ke,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:_e.classNames.concat([Ke.className])});var kt=T(54416);class xe extends kt.T{constructor(){super(...arguments),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_changed(){if(super._changed(),this.isDirty("fillStyle")){const t=this.series,e=this.dataItem;t&&e&&t._updateLinkColor(e)}}_getTooltipPoint(){let t=this.get("tooltipY"),e=.5;return t instanceof j.gG&&(e=t.value),this.getPoint(e)}}Object.defineProperty(xe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowLink"}),Object.defineProperty(xe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:kt.T.classNames.concat([xe.className])});class Ne extends xe{constructor(){super(...arguments),Object.defineProperty(this,"_p0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getPoint(t){if(this._p0&&this._p1){if("line"===this._type){let e=C.Zb(this._p0,this._p1,t);return{x:e.x,y:e.y,angle:C._O(this._p0,this._p1)}}{let e=C.YH(this._p0,this._p1,{x:0,y:0},Math.max(0,t-.01)),i=C.YH(this._p0,this._p1,{x:0,y:0},Math.min(1,t+.01)),a=C.YH(this._p0,this._p1,{x:0,y:0},t);return{x:a.x,y:a.y,angle:C._O(e,i)}}}return{x:0,y:0,angle:0}}}Object.defineProperty(Ne,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLink"}),Object.defineProperty(Ne,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:xe.classNames.concat([Ne.className])});var Ae=T(43933);class De extends J{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new we.o(ke.YS.new({}),()=>Ne._new(this._root,{themeTags:["link","shape"]},[this.links.template]))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Ke.new(this._root,{}))}),Object.defineProperty(this,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:Te(!1,!1)}),Object.defineProperty(this,"_chordLayout",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_ribbon",{enumerable:!0,configurable:!0,writable:!0,value:ft()})}_afterNew(){this._settings.themeTags=Ae.Fy(this._settings.themeTags,["chord"]),this.linksContainer.setAll({x:j.CI,y:j.CI}),this.bulletsContainer.setAll({x:j.CI,y:j.CI}),super._afterNew()}_fixRibbon(t){t.startAngle(e=>e.startAngle+this.get("startAngle",0)*C.sE+Math.PI/2),t.endAngle(e=>e.endAngle+this.get("startAngle",0)*C.sE+Math.PI/2)}makeLink(t){const e=this.linksContainer.children.push(this.links.make());return this.links.push(e),e._setDataItem(t),e.set("source",t.get("source")),e.set("target",t.get("target")),e.series=this,e}_makeMatrix(){const t=[];return U.S6(this.nodes.dataItems,e=>{const i=[];t.push(i);let a=e.get("outgoingLinks");U.S6(this.nodes.dataItems,s=>{let o=0;a&&U.S6(a,l=>{l.get("target")===s&&(o=l.get("valueWorking"));let u=this.getPrivate("valueSum",0),b=this.get("minSize",0);o>0&&b>0&&o<u*b&&(o=u*b)}),i.push(o)})}),t}_prepareChildren(){super._prepareChildren(),this._fixRibbon(this._ribbon);let t=!1;if(this._valuesDirty||this._sizeDirty||this.isDirty("padAngle")||this.isDirty("startAngle")){const e=this._makeMatrix();this._d3chord.padAngle(this.get("padAngle",0)*C.sE);const i=this.get("sort");"ascending"===i?this._d3chord.sortGroups(It):"descending"===i&&this._d3chord.sortGroups(Gt),this._chordLayout=this._d3chord(e),t=!0}if(t||this.isDirty("radius")||this.isDirty("nodeWidth")){let e=Ae.Iy(this.get("radius",0),Math.min(this.innerWidth(),this.innerHeight()))/2,i=0;const a=this.get("startAngle",0),s=this.get("nodeWidth",0);U.S6(this.nodes.dataItems,l=>{const u=l.get("slice"),b=this._chordLayout.groups[i],v=b.startAngle*C.v4+a,A=b.endAngle*C.v4+a;u.setAll({radius:e,innerRadius:e-s,startAngle:v,arc:A-v});const S=l.get("label");S.setAll({labelAngle:v+(A-v)/2}),S.setPrivate("radius",e),S.setPrivate("innerRadius",.1),i++});const o=e-this.get("nodeWidth",0);U.S6(this._chordLayout,l=>{let u=this._linksByIndex[l.source.index+"_"+l.target.index];if(u||(u=this._linksByIndex[l.target.index+"_"+l.source.index]),u){const b=u.get("link");this._getLinkPoints(b,o,l),this._updateLink(this._ribbon,b,o,l)}})}}_getLinkPoints(t,e,i){const a=i.source,s=i.target,o=this.get("startAngle",0)*C.sE;if(a&&s){const l=a.startAngle,b=l+(a.endAngle-l)/2+o,v=s.startAngle,S=v+(s.endAngle-v)/2+o;t._p0={x:e*Math.cos(b),y:e*Math.sin(b)},t._p1={x:e*Math.cos(S),y:e*Math.sin(S)}}}_updateLink(t,e,i,a){a&&(t.sourceRadius(Ae.Iy(e.get("sourceRadius",j.AQ),i)),t.targetRadius(Ae.Iy(e.get("targetRadius",j.AQ),i)),e.set("draw",s=>{t.context(s),t(a)}))}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("label");e&&e.dispose()}}Object.defineProperty(De,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Chord"}),Object.defineProperty(De,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:J.classNames.concat([De.className])});class Xe extends Ne{_afterNew(){this._settings.themeTags=Ae.Fy(this._settings.themeTags,["chord","link","directed"]),super._afterNew()}}Object.defineProperty(Xe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLinkDirected"}),Object.defineProperty(Xe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ne.classNames.concat([Xe.className])});class qe extends De{constructor(){super(...arguments),Object.defineProperty(this,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:Te(!0,!1)}),Object.defineProperty(this,"_ribbonArrow",{enumerable:!0,configurable:!0,writable:!0,value:gt()}),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new we.o(ke.YS.new({}),()=>Xe._new(this._root,{themeTags:["link","shape"]},[this.links.template]))})}makeLink(t){const e=this.linksContainer.children.push(this.links.make());return e._setDataItem(t),e.set("source",t.get("source")),e.set("target",t.get("target")),e.series=this,e}_afterNew(){this._settings.themeTags=Ae.Fy(this._settings.themeTags,["directed"]),super._afterNew(),this._markDirtyKey("linkHeadRadius")}_prepareChildren(){const t="linkHeadRadius";if(this.isDirty(t)){const e=this.get(t);if(null==e)this._ribbon=ft();else{let i=gt();i.headRadius(e),this._ribbon=i}}super._prepareChildren()}}Object.defineProperty(qe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordDirected"}),Object.defineProperty(qe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:De.classNames.concat([qe.className])});class et extends De{_afterNew(){this._settings.themeTags=Ae.Fy(this._settings.themeTags,["chord","basic"]),super._afterNew()}_makeMatrix(){const t=[];return U.S6(this.nodes.dataItems,e=>{const i=[];t.push(i),U.S6(this.nodes.dataItems,a=>{let s=1;e===a&&(s=0),i.push(s)})}),t}_updateLink(t,e,i,a){if(e._type=this.get("linkType"),a){const s=this.get("linkType");e.set("draw",o=>{let l=e._p0,u=e._p1;l&&u&&(o.moveTo(l.x,l.y),"line"==s?o.lineTo(u.x,u.y):o.quadraticCurveTo(0,0,u.x,u.y))})}}_getLinkPoints(t,e,i){const a=t.get("source"),s=t.get("target");if(a&&s){const o=a.get("slice"),l=s.get("slice"),v=o.get("startAngle",0)+o.get("arc",0)/2,L=l.get("startAngle",0)+l.get("arc",0)/2;t._p0={x:e*C.mC(v),y:e*C.O$(v)},t._p1={x:e*C.mC(L),y:e*C.O$(L)}}}}Object.defineProperty(et,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNonRibbon"}),Object.defineProperty(et,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:De.classNames.concat([et.className])});var rn=T(6905);class Ue extends _e{constructor(){super(...arguments),Object.defineProperty(this,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:new we.o(ke.YS.new({}),()=>rn.c._new(this._root,{themeTags:["shape"]},[this.rectangles.template]))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}makeNode(t){const e=this.flow,i=super.makeNode(t,"sankey"),a=i.children.insertIndex(0,this.rectangles.make());this.rectangles.push(a),a._setSoft("fill",t.get("fill")),t.set("rectangle",a),i.events.on("dragged",()=>{const o=i.dataItem.get("d3SankeyNode");o&&e&&("horizontal"==e.get("orientation")?(o.x0=i.x(),o.y0=i.y()):(o.x0=i.y(),o.y0=i.x()),e.updateSankey())});const s=this.labels.make();return this.labels.push(s),e&&s.addTag(e.get("orientation","")),i.children.push(s),t.set("label",s),s._setDataItem(t),a._setDataItem(t),i}_positionBullet(t){const e=t.get("sprite");if(e){const i=e.dataItem;if(i){const a=t.get("sprite");if(a){const s=i.get("rectangle"),o=i.get("node"),l=t.get("locationX",.5),u=t.get("locationY",.5);s&&a.setAll({x:o.x()+s.width()*l,y:o.y()+s.height()*u})}}}}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("rectangle");e&&(this.rectangles.removeValue(e),e.dispose())}}Object.defineProperty(Ue,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyNodes"}),Object.defineProperty(Ue,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:_e.classNames.concat([Ue.className])});class Ve extends xe{constructor(){super(...arguments),Object.defineProperty(this,"_svgPath",{enumerable:!0,configurable:!0,writable:!0,value:document.createElementNS("http://www.w3.org/2000/svg","path")}),Object.defineProperty(this,"_totalLength",{enumerable:!0,configurable:!0,writable:!0,value:0})}_beforeChanged(){if(super._beforeChanged(),this.isDirty("source")){const s=this.get("source");if(s){const o=s.get("node");this._disposers.push(o.events.on("positionchanged",()=>{this.markDirty()}))}}if(this.isDirty("target")){const s=this.get("target");if(s){const o=s.get("node");this._disposers.push(o.events.on("positionchanged",()=>{this.markDirty()}))}}if(this.isPrivateDirty("orientation")){const s=this.series,o=this.dataItem;o&&s&&s._updateLinkColor(o)}const t=this.get("target"),e=this.get("source");let i,a;if(e&&t){this._clear=!0,i=e.get("node"),a=t.get("node");let s=0,o=0,l=0,u=0,b=0,v=0,A=0,S=0,L=0,P=0,M=0,f=0,p=0,x=0,m=0,w=0,E=0,z=0;const re=this.dataItem;if(re){const X=re.get("d3SankeyLink");if(X){let H=X.width||0,$=this.getPrivate("orientation");"vertical"==$?(i&&(l=i.y()),a&&(u=a.y()),E=90,z=90,s=X.y0||0,o=X.y1||0,u<l&&([s,o]=[o,s],[l,u]=[u,l]),e.get("unknown")&&(s=o,l+=(u-l)/2),t.get("unknown")&&(o=s,u=l+(u-l)/2),b=s-H/2,v=l,A=o-H/2,S=u,L=s+H/2,P=o+H/2,M=l,f=u,p=s,x=o,m=l,w=u):(i&&(s=i.x()),a&&(o=a.x()),l=X.y0||0,u=X.y1||0,o<s&&([s,o]=[o,s],[l,u]=[u,l]),e.get("unknown")&&(l=u,s+=(o-s)/2),t.get("unknown")&&(u=l,o=s+(o-s)/2),b=s,v=l-H/2,A=o,S=u-H/2,L=s,P=o,M=l+H/2,f=u+H/2,p=s,x=o,m=l,w=u),C.NM(b,3)==C.NM(A,3)&&(A+=.01),C.NM(v,3)==C.NM(S,3)&&(S+=.01),C.NM(L,3)==C.NM(P,3)&&(P+=.01),C.NM(M,3)==C.NM(f,3)&&(f+=.01);let G=this.get("controlPointDistance",.2);G=Math.min(.4999,G);let ae=b+(A-b)*G*C.mC(E),q=v+(S-v)*G*C.O$(E),h=A-(A-b)*G*C.mC(z),r=S-(S-v)*G*C.O$(z),c=p+(x-p)*G*C.mC(E),g=m+(w-m)*G*C.O$(E),y=x-(x-p)*G*C.mC(z),d=w-(w-m)*G*C.O$(z),k=C._O({x:ae,y:q},{x:h,y:r}),_=(H/C.mC(k)-H)/C.OR(k)*C.mC(E),O=(H/C.O$(k)-H)*C.OR(k)*C.O$(E),ee=-_/2+L+(P-L)*G*C.mC(E),Z=-O/2+M+(f-M)*G*C.O$(E),te=-_/2+P-(P-L)*G*C.mC(z),ie=-O/2+f-(f-M)*G*C.O$(z);ae+=_/2,q+=O/2,h+=_/2,r+=O/2,"vertical"==$?(q=Math.min(S,Math.max(v+1,q)),Z=Math.min(f,Math.max(M+1,Z)),r=Math.max(v,Math.min(S-1,r)),ie=Math.max(M,Math.min(f-1,ie))):(ae=Math.min(A,Math.max(b+1,ae)),ee=Math.min(P,Math.max(L+1,ee)),h=Math.max(b,Math.min(A-1,h)),te=Math.max(L,Math.min(P-1,te)));let W=[[b,v,L,M],[ae,q,ee,Z],[h,r,te,ie],[A,S,P,f]];this.set("draw",Se=>{const He=this.series;He._fillGenerator.context(Se),He._fillGenerator(W)});const ve=this.series._strokeGenerator([[p,m],[c,g],[y,d],[x,w]]);ve&&(this._svgPath.setAttribute("d",ve),this._totalLength=this._svgPath.getTotalLength())}}}this.series&&this.dataItem&&this.series._positionBullets(this.dataItem)}getPoint(t){if(this._svgPath&&this._svgPath.getAttribute("d")){let e=this._svgPath.getPointAtLength(t*this._totalLength-.1),i=this._svgPath.getPointAtLength(t*this._totalLength+.1),a=this.toGlobal(this._svgPath.getPointAtLength(t*this._totalLength));return{x:a.x,y:a.y,angle:C._O(e,i)}}return{x:0,y:0,angle:0}}_getTooltipPoint(){return this.toLocal(super._getTooltipPoint())}}Object.defineProperty(Ve,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyLink"}),Object.defineProperty(Ve,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:xe.classNames.concat([Ve.className])});var sn=T(62426),on=T(69706),wt=T(12688),_t=T(23220);function lt(n,t){let e=0;if(void 0===t)for(let i of n)(i=+i)&&(e+=i);else{let i=-1;for(let a of n)(a=+t(a,++i,n))&&(e+=a)}return e}function xt(n,t){let e;if(void 0===t)for(const i of n)null!=i&&(e<i||void 0===e&&i>=i)&&(e=i);else{let i=-1;for(let a of n)null!=(a=t(a,++i,n))&&(e<a||void 0===e&&a>=a)&&(e=a)}return e}function At(n,t){let e;if(void 0===t)for(const i of n)null!=i&&(e>i||void 0===e&&i>=i)&&(e=i);else{let i=-1;for(let a of n)null!=(a=t(a,++i,n))&&(e>a||void 0===e&&a>=a)&&(e=a)}return e}function an(n){return n.target.depth}function ln(n){return n.depth}function un(n,t){return t-1-n.height}function Dt(n,t){return n.sourceLinks.length?n.depth:t-1}function cn(n){return n.targetLinks.length?n.depth:n.sourceLinks.length?At(n.sourceLinks,an)-1:0}function tt(n){return function(){return n}}function Pt(n,t){return nt(n.source,t.source)||n.index-t.index}function Lt(n,t){return nt(n.target,t.target)||n.index-t.index}function nt(n,t){return n.y0-t.y0}function ut(n){return n.value}function hn(n){return n.index}function fn(n){return n.nodes}function gn(n){return n.links}function Tt(n,t){const e=n.get(t);if(!e)throw new Error("missing: "+t);return e}function Ot({nodes:n}){for(const t of n){let e=t.y0,i=e;for(const a of t.sourceLinks)a.y0=e+a.width/2,e+=a.width;for(const a of t.targetLinks)a.y1=i+a.width/2,i+=a.width}}function dn(){let o,b,v,n=0,t=0,e=1,i=1,a=24,s=8,l=hn,u=Dt,A=fn,S=gn,L=6;function P(){const r={nodes:A.apply(null,arguments),links:S.apply(null,arguments)};return function M({nodes:r,links:c}){for(const[y,d]of r.entries())d.index=y,d.sourceLinks=[],d.targetLinks=[];const g=new Map(r.map((y,d)=>[l(y,d,r),y]));for(const[y,d]of c.entries()){d.index=y;let{source:k,target:_}=d;"object"!=typeof k&&(k=d.source=Tt(g,k)),"object"!=typeof _&&(_=d.target=Tt(g,_)),k.sourceLinks.push(d),_.targetLinks.push(d)}if(null!=v)for(const{sourceLinks:y,targetLinks:d}of r)y.sort(v),d.sort(v)}(r),function f({nodes:r}){for(const c of r)c.value=void 0===c.fixedValue?Math.max(lt(c.sourceLinks,ut),lt(c.targetLinks,ut)):c.fixedValue}(r),function p({nodes:r}){const c=r.length;let g=new Set(r),y=new Set,d=0;for(;g.size;){for(const k of g){k.depth=d;for(const{target:_}of k.sourceLinks)y.add(_)}if(++d>c)throw new Error("circular link");g=y,y=new Set}}(r),function x({nodes:r}){const c=r.length;let g=new Set(r),y=new Set,d=0;for(;g.size;){for(const k of g){k.height=d;for(const{source:_}of k.targetLinks)y.add(_)}if(++d>c)throw new Error("circular link");g=y,y=new Set}}(r),function E(r){const c=function m({nodes:r}){const c=xt(r,d=>d.depth)+1,g=(e-n-a)/(c-1),y=new Array(c);for(const d of r){const k=Math.max(0,Math.min(c-1,Math.floor(u.call(null,d,c))));d.layer=k,d.x0=n+k*g,d.x1=d.x0+a,y[k]?y[k].push(d):y[k]=[d]}if(b)for(const d of y)d.sort(b);return y}(r);o=Math.min(s,(i-t)/(xt(c,g=>g.length)-1)),function w(r){const c=At(r,g=>(i-t-(g.length-1)*o)/lt(g,ut));for(const g of r){let y=t;for(const d of g){d.y0=y,d.y1=y+d.value*c,y=d.y1+o;for(const k of d.sourceLinks)k.width=k.value*c}y=(i-y+o)/(g.length+1);for(let d=0;d<g.length;++d){const k=g[d];k.y0+=y*(d+1),k.y1+=y*(d+1)}ae(g)}}(c);for(let g=0;g<L;++g){const y=Math.pow(.99,g),d=Math.max(1-y,(g+1)/L);re(c,y,d),z(c,y,d)}}(r),Ot(r),r}function z(r,c,g){for(let y=1,d=r.length;y<d;++y){const k=r[y];for(const _ of k){let O=0,ee=0;for(const{source:te,value:ie}of _.targetLinks){let W=ie*(_.layer-te.layer);O+=q(te,_)*W,ee+=W}if(!(ee>0))continue;let Z=(O/ee-_.y0)*c;_.y0+=Z,_.y1+=Z,G(_)}void 0===b&&k.sort(nt),X(k,g)}}function re(r,c,g){for(let d=r.length-2;d>=0;--d){const k=r[d];for(const _ of k){let O=0,ee=0;for(const{target:te,value:ie}of _.sourceLinks){let W=ie*(te.layer-_.layer);O+=h(_,te)*W,ee+=W}if(!(ee>0))continue;let Z=(O/ee-_.y0)*c;_.y0+=Z,_.y1+=Z,G(_)}void 0===b&&k.sort(nt),X(k,g)}}function X(r,c){const g=r.length>>1,y=r[g];$(r,y.y0-o,g-1,c),H(r,y.y1+o,g+1,c),$(r,i,r.length-1,c),H(r,t,0,c)}function H(r,c,g,y){for(;g<r.length;++g){const d=r[g],k=(c-d.y0)*y;k>1e-6&&(d.y0+=k,d.y1+=k),c=d.y1+o}}function $(r,c,g,y){for(;g>=0;--g){const d=r[g],k=(d.y1-c)*y;k>1e-6&&(d.y0-=k,d.y1-=k),c=d.y0-o}}function G({sourceLinks:r,targetLinks:c}){if(void 0===v){for(const{source:{sourceLinks:g}}of c)g.sort(Lt);for(const{target:{targetLinks:g}}of r)g.sort(Pt)}}function ae(r){if(void 0===v)for(const{sourceLinks:c,targetLinks:g}of r)c.sort(Lt),g.sort(Pt)}function q(r,c){let g=r.y0-(r.sourceLinks.length-1)*o/2;for(const{target:y,width:d}of r.sourceLinks){if(y===c)break;g+=d+o}for(const{source:y,width:d}of c.targetLinks){if(y===r)break;g-=d}return g}function h(r,c){let g=c.y0-(c.targetLinks.length-1)*o/2;for(const{source:y,width:d}of c.targetLinks){if(y===r)break;g+=d+o}for(const{target:y,width:d}of r.sourceLinks){if(y===c)break;g-=d}return g}return P.update=function(r){return Ot(r),r},P.nodeId=function(r){return arguments.length?(l="function"==typeof r?r:tt(r),P):l},P.nodeAlign=function(r){return arguments.length?(u="function"==typeof r?r:tt(r),P):u},P.nodeSort=function(r){return arguments.length?(b=r,P):b},P.nodeWidth=function(r){return arguments.length?(a=+r,P):a},P.nodePadding=function(r){return arguments.length?(s=o=+r,P):s},P.nodes=function(r){return arguments.length?(A="function"==typeof r?r:tt(r),P):A},P.links=function(r){return arguments.length?(S="function"==typeof r?r:tt(r),P):S},P.linkSort=function(r){return arguments.length?(v=r,P):v},P.size=function(r){return arguments.length?(n=t=0,e=+r[0],i=+r[1],P):[e-n,i-t]},P.extent=function(r){return arguments.length?(n=+r[0][0],e=+r[1][0],t=+r[0][1],i=+r[1][1],P):[[n,t],[e,i]]},P.iterations=function(r){return arguments.length?(L=+r,P):L},P}class it extends J{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new we.o(ke.YS.new({}),()=>Ve._new(this._root,{themeTags:["link","shape"]},[this.links.template]))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Ue.new(this._root,{}))}),Object.defineProperty(this,"_d3Sankey",{enumerable:!0,configurable:!0,writable:!0,value:dn()}),Object.defineProperty(this,"_d3Graph",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,sn.Z)()}),Object.defineProperty(this,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,on.Z)()})}_afterNew(){this._settings.themeTags=Ae.Fy(this._settings.themeTags,["sankey",this._settings.orientation||"horizontal"]),this._fillGenerator.y0(function(t){return t[3]}),this._fillGenerator.x0(function(t){return t[2]}),this._fillGenerator.y1(function(t){return t[1]}),this._fillGenerator.x1(function(t){return t[0]}),super._afterNew()}makeLink(t){const e=t.get("source"),i=t.get("target"),a=this.links.make();return e.get("unknown")&&(a.addTag("source"),a.addTag("unknown")),i.get("unknown")&&(a.addTag("target"),a.addTag("unknown")),this.linksContainer.children.push(a),a._setDataItem(t),a.set("source",e),a.set("target",i),a.series=this,this.links.push(a),a}updateSankey(){const t=this._d3Graph;t&&(this._d3Sankey.update(t),U.S6(this.dataItems,e=>{const i=e.get("link");i.setPrivate("orientation",this.get("orientation")),i.markDirty()}))}_updateLinkColor(t){super._updateLinkColor(t);const e=this.get("orientation"),i=t.get("link")._fillGradient,a=t.get("link")._strokeGradient;"vertical"==e?(i&&i.set("rotation",90),a&&a.set("rotation",90)):(i&&i.set("rotation",0),a&&a.set("rotation",0))}_getBulletLocation(t){return"vertical"==this.get("orientation")?t.get("locationY",0):t.get("locationX",0)}_prepareChildren(){super._prepareChildren();let t=!1;if("vertical"==this.get("orientation")&&(t=!0),this.isDirty("orientation")||this.isDirty("linkTension")){const e=this.get("linkTension",.5);t?(this._fillGenerator.curve((0,_t.$)(e)),this._strokeGenerator.curve((0,_t.$)(e))):(this._fillGenerator.curve((0,wt.G)(e)),this._strokeGenerator.curve((0,wt.G)(e)))}if((this._valuesDirty||this._sizeDirty||this.isDirty("nodePadding")||this.isDirty("nodeWidth")||this.isDirty("nodeAlign")||this.isDirty("nodeSort")||this.isDirty("orientation")||this.isDirty("linkTension"))&&this._nodesData.length>0){const e=this._d3Sankey;let i=this.innerWidth(),a=this.innerHeight();switch(t&&([i,a]=[a,i]),e.size([i,a]),e.nodePadding(this.get("nodePadding",10)),e.nodeWidth(this.get("nodeWidth",10)),e.nodeSort(this.get("nodeSort",null)),this.get("nodeAlign")){case"right":e.nodeAlign(un);break;case"justify":e.nodeAlign(Dt);break;case"center":e.nodeAlign(cn);break;default:e.nodeAlign(ln)}this._d3Graph=e({nodes:this._nodesData,links:this._linksData}),U.S6(this.dataItems,o=>{const l=o.get("link");l.setPrivate("orientation",this.get("orientation")),l.markDirty()});const s=this._d3Graph;s&&U.S6(s.nodes,l=>{const u=l.dataItem,b=u.get("node");let v,A,S,L;t?(v=l.y0,A=l.y1,S=l.x0,L=l.x1):(v=l.x0,A=l.x1,S=l.y0,L=l.y1),Q.hj(v)&&Q.hj(A)&&Q.hj(S)&&Q.hj(L)&&(b.setAll({x:v,y:S,width:A-v,height:L-S}),u.get("rectangle").setAll({width:A-v,height:L-S}))})}}}Object.defineProperty(it,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sankey"}),Object.defineProperty(it,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:J.classNames.concat([it.className])})},62426:(Me,me,T)=>{T.d(me,{Z:()=>ge});var le=T(79817),F=T(73047),j=T(32701),pe=T(69706),ye=T(50636),U=T(19631);function ge(V,K,Y){var Q=null,J=(0,F.Z)(!0),ue=null,B=j.Z,N=null,se=(0,ye.d)(I);function I(D){var ne,Ee,Le,Re,Te,je=(D=(0,le.Z)(D)).length,ze=!1,We=new Array(je),Fe=new Array(je);for(null==ue&&(N=B(Te=se())),ne=0;ne<=je;++ne){if(!(ne<je&&J(Re=D[ne],ne,D))===ze)if(ze=!ze)Ee=ne,N.areaStart(),N.lineStart();else{for(N.lineEnd(),N.lineStart(),Le=ne-1;Le>=Ee;--Le)N.point(We[Le],Fe[Le]);N.lineEnd(),N.areaEnd()}ze&&(We[ne]=+V(Re,ne,D),Fe[ne]=+K(Re,ne,D),N.point(Q?+Q(Re,ne,D):We[ne],Y?+Y(Re,ne,D):Fe[ne]))}if(Te)return N=null,Te+""||null}function de(){return(0,pe.Z)().defined(J).curve(B).context(ue)}return V="function"==typeof V?V:void 0===V?U.x:(0,F.Z)(+V),K="function"==typeof K?K:(0,F.Z)(void 0===K?0:+K),Y="function"==typeof Y?Y:void 0===Y?U.y:(0,F.Z)(+Y),I.x=function(D){return arguments.length?(V="function"==typeof D?D:(0,F.Z)(+D),Q=null,I):V},I.x0=function(D){return arguments.length?(V="function"==typeof D?D:(0,F.Z)(+D),I):V},I.x1=function(D){return arguments.length?(Q=null==D?null:"function"==typeof D?D:(0,F.Z)(+D),I):Q},I.y=function(D){return arguments.length?(K="function"==typeof D?D:(0,F.Z)(+D),Y=null,I):K},I.y0=function(D){return arguments.length?(K="function"==typeof D?D:(0,F.Z)(+D),I):K},I.y1=function(D){return arguments.length?(Y=null==D?null:"function"==typeof D?D:(0,F.Z)(+D),I):Y},I.lineX0=I.lineY0=function(){return de().x(V).y(K)},I.lineY1=function(){return de().x(V).y(Y)},I.lineX1=function(){return de().x(Q).y(K)},I.defined=function(D){return arguments.length?(J="function"==typeof D?D:(0,F.Z)(!!D),I):J},I.curve=function(D){return arguments.length?(B=D,null!=ue&&(N=B(ue)),I):B},I.context=function(D){return arguments.length?(null==D?ue=N=null:N=B(ue=D),I):ue},I}},79817:(Me,me,T)=>{function F(j){return"object"==typeof j&&"length"in j?j:Array.from(j)}T.d(me,{Z:()=>F})},32701:(Me,me,T)=>{function le(j){this._context=j}function F(j){return new le(j)}T.d(me,{Z:()=>F}),le.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(j,pe){switch(j=+j,pe=+pe,this._point){case 0:this._point=1,this._line?this._context.lineTo(j,pe):this._context.moveTo(j,pe);break;case 1:this._point=2;default:this._context.lineTo(j,pe)}}}},69706:(Me,me,T)=>{T.d(me,{Z:()=>U});var le=T(79817),F=T(73047),j=T(32701),pe=T(50636),ye=T(19631);function U(ge,V){var K=(0,F.Z)(!0),Y=null,Q=j.Z,J=null,ue=(0,pe.d)(B);function B(N){var se,de,ne,I=(N=(0,le.Z)(N)).length,D=!1;for(null==Y&&(J=Q(ne=ue())),se=0;se<=I;++se)!(se<I&&K(de=N[se],se,N))===D&&((D=!D)?J.lineStart():J.lineEnd()),D&&J.point(+ge(de,se,N),+V(de,se,N));if(ne)return J=null,ne+""||null}return ge="function"==typeof ge?ge:void 0===ge?ye.x:(0,F.Z)(ge),V="function"==typeof V?V:void 0===V?ye.y:(0,F.Z)(V),B.x=function(N){return arguments.length?(ge="function"==typeof N?N:(0,F.Z)(+N),B):ge},B.y=function(N){return arguments.length?(V="function"==typeof N?N:(0,F.Z)(+N),B):V},B.defined=function(N){return arguments.length?(K="function"==typeof N?N:(0,F.Z)(!!N),B):K},B.curve=function(N){return arguments.length?(Q=N,null!=Y&&(J=Q(Y)),B):Q},B.context=function(N){return arguments.length?(null==N?Y=J=null:J=Q(Y=N),B):Y},B}},19631:(Me,me,T)=>{function le(j){return j[0]}function F(j){return j[1]}T.d(me,{x:()=>le,y:()=>F})}}]);